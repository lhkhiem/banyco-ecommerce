(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7966],{582:function(e,t,r){Promise.resolve().then(r.bind(r,7762))},7762:function(e,t,r){"use strict";r.d(t,{default:function(){return g}});var a=r(7437),l=r(2265),n=r(7996),s=r(9376),i=r(3276),c=r(3184),o=r(806),d=r(4226),m=r(7835),u=r.n(m),h=r(5862);let p="/images/placeholder-product.jpg",x=h.T4;function g(e){var t,r,m,h,g,v,f,y,j,N,w;let{product:k}=e,C=(0,s.useRouter)(),M=(0,l.useMemo)(()=>{var e;return null!==(e=k.variants)&&void 0!==e?e:[]},[k.variants]),S=k.variantCount>1&&M.length>0,[P,T]=(0,l.useState)(0),[A,E]=(0,l.useState)(1),[L,_]=(0,l.useState)("details"),[I,O]=(0,l.useState)({}),[R,D]=(0,l.useState)(!1),V=(0,l.useRef)(null),F=(0,l.useMemo)(()=>M.length?(k.selectedVariantId?M.find(e=>e.id===k.selectedVariantId):null)||(1===M.length?M[0]:null):null,[k.selectedVariantId,M]);(0,l.useEffect)(()=>{if(!S||!M.length||!F){O({});return}let e={};F.optionValues.forEach(t=>{t.optionName&&(e[t.optionName]=t.value)}),O(e)},[F,S,k.id,M.length]);let W=(0,l.useCallback)((e,t)=>{let r=Object.entries(t);return!r.length||r.every(t=>{let[r,a]=t,l=e.optionValues.find(e=>e.optionName===r);return(null==l?void 0:l.value)===a})},[]),z=(0,l.useCallback)(e=>!!M.length&&(!Object.entries(e).length||M.some(t=>W(t,e))),[W,M]),U=(0,l.useCallback)((e,t)=>{if(!Object.keys(e).length)return e;let r={...e};if(z(r))return r;let a=!0;for(;a;){if(a=!1,z(r))return r;for(let e of Object.keys(r)){if(t&&e===t)continue;let l={...r};if(delete l[e],z(l)){r=l,a=!0;break}}}if(t&&void 0!==r[t]){let e={[t]:r[t]};if(z(e))return e}return{}},[z]),q=(0,l.useMemo)(()=>{let e=new Map;return M.forEach(t=>{t.optionValues.forEach(t=>{t.optionName&&(e.has(t.optionName)||e.set(t.optionName,new Set),e.get(t.optionName).add(t.value))})}),Array.from(e.entries()).map(e=>{let[t,r]=e;return{name:t,values:Array.from(r).sort((e,t)=>e.localeCompare(t))}})},[M]),B=(0,l.useMemo)(()=>S?M.filter(e=>W(e,I)):[],[S,I,W,M]),G=(0,l.useMemo)(()=>{if(!S||!B.length)return null;if(1===B.length){let[e]=B;return e.optionValues.filter(e=>e.optionName).map(e=>e.optionName).every(e=>e&&void 0!==I[e])?e:null}return null},[S,B,I]),H=null!==(m=null==G?void 0:G.id)&&void 0!==m?m:null,Z=S?G?G.stock:0:Number.isFinite(Number(k.stock))?Number(k.stock):0;(0,l.useEffect)(()=>{S&&G&&G.slug&&G.slug!==k.slug&&C.replace("/products/".concat(G.slug),{scroll:!1})},[G,S,k.slug,C]),(0,l.useEffect)(()=>{E(e=>S?!G||G.stock<=0?1:Math.min(e,G.stock):Z<=0?1:Math.min(e,Z))},[G,Z,S]);let K=(0,l.useCallback)((e,t)=>{O(r=>{if(r[e]===t){let t={...r};return delete t[e],U(t)}return U({...r,[e]:t},e)})},[U]),X=k.images.length>0?k.images:[{id:"fallback",url:b(k),width:null,height:null,format:null}],{displayPrice:J,salePrice:Q,discountPercentage:Y,comparePrice:$}=(0,l.useMemo)(()=>{if(G){let e=Number(G.price),t=null!==G.comparePrice&&void 0!==G.comparePrice?Number(G.comparePrice):null,r=null!==t&&t>e;return{displayPrice:r&&null!==t?t:e,salePrice:r?e:null,comparePrice:r?t:null,discountPercentage:r&&t?Math.round((t-e)/t*100):0}}let e=B.length?B:M;if(!e.length){let e=Number(k.price),t=null!==k.comparePrice&&void 0!==k.comparePrice?Number(k.comparePrice):null,r=null!==t&&t>e;return{displayPrice:r&&null!==t?t:e,salePrice:r?e:null,comparePrice:r?t:null,discountPercentage:r&&t?Math.round((t-e)/t*100):0}}let t=e.map(e=>Number(e.price)),r=Math.min(...t),a=Math.max(...t);return{displayPrice:r,salePrice:null,comparePrice:a!==r?a:null,discountPercentage:0}},[G,B,k.comparePrice,k.price,M]),ee=(0,l.useCallback)((e,t)=>I[e]!==t&&!z({...I,[e]:t}),[z,I]),et=(0,l.useCallback)(e=>e.summary&&e.summary.length>0?e.summary:e.optionValues.filter(e=>e.optionName).map(e=>"".concat(e.optionName,": ").concat(e.value)).join(" • "),[]),er=S?null!==(v=null!==(g=null!==(h=null==G?void 0:G.sku)&&void 0!==h?h:k.baseSku)&&void 0!==g?g:k.sku)&&void 0!==v?v:void 0:null!==(y=null!==(f=k.sku)&&void 0!==f?f:k.baseSku)&&void 0!==y?y:void 0,ea=(0,l.useMemo)(()=>{var e;let t=null!==(e=k.baseName)&&void 0!==e?e:k.name;if(!S||!G)return t;let r=et(G);return r?"".concat(t," (").concat(r,")"):t},[G,et,S,k.baseName,k.name]),el=k.relatedProducts.map(e=>{var t;return{id:e.id,productId:e.id,variantId:void 0,slug:e.slug,name:e.name,price:e.comparePrice&&e.comparePrice>e.price?e.comparePrice:e.price,salePrice:e.comparePrice&&e.comparePrice>e.price?e.price:void 0,image:null!==(t=e.thumbnailUrl)&&void 0!==t?t:p,rating:e.rating,reviewCount:e.reviewCount,badge:e.isBestSeller?"B\xe1n chạy":e.isFeatured?"Nổi bật":void 0,inStock:e.inStock}}),en=k.attributes.filter(e=>e.name&&e.value),es=k.reviewCount>0?"".concat(k.reviewCount," đ\xe1nh gi\xe1"):"Chưa c\xf3 đ\xe1nh gi\xe1",ei=(0,l.useMemo)(()=>Number(null!=Q?Q:J),[J,Q]),ec=null!==(j=null===(t=X[P])||void 0===t?void 0:t.url)&&void 0!==j?j:b(k);(0,l.useEffect)(()=>{let e=e=>{V.current&&!V.current.contains(e.target)&&D(!1)};return R&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[R]);let eo=(0,l.useMemo)(()=>window.location.href,[]),ed=(0,l.useCallback)(async()=>{let e={title:k.name,text:k.description||"Xem sản phẩm ".concat(k.name),url:eo};if(navigator.share)try{await navigator.share(e),D(!1);return}catch(e){"AbortError"!==e.name&&console.error("Error sharing:",e)}D(!R)},[k.name,k.description,eo,R]),em=(0,l.useCallback)(async()=>{try{await navigator.clipboard.writeText(eo),D(!1),alert("Đ\xe3 sao ch\xe9p link v\xe0o clipboard!")}catch(e){console.error("Failed to copy:",e),alert("Kh\xf4ng thể sao ch\xe9p link")}},[eo]),eu=(0,l.useCallback)(()=>{let e="https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(eo));window.open(e,"_blank","width=600,height=400"),D(!1)},[eo]),eh=(0,l.useCallback)(()=>{let e="https://twitter.com/intent/tweet?url=".concat(encodeURIComponent(eo),"&text=").concat(encodeURIComponent(k.name));window.open(e,"_blank","width=600,height=400"),D(!1)},[eo,k.name]);return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"container-custom py-8",children:[(0,a.jsx)(i.Z,{items:k.breadcrumb,className:"mb-6"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"relative aspect-square overflow-hidden rounded-lg bg-white",children:[Y>0&&(0,a.jsxs)("div",{className:"absolute left-4 top-4 z-10 rounded-full bg-red-500 px-3 py-1 text-sm font-bold text-white",children:["Tiết kiệm ",Y,"%"]}),(0,a.jsx)(d.default,{src:null!==(N=null===(r=X[P])||void 0===r?void 0:r.url)&&void 0!==N?N:p,alt:k.name,fill:!0,className:"object-cover",priority:!0,fallbackSrc:p})]}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-4",children:X.map((e,t)=>{var r,l;return(0,a.jsx)("button",{onClick:()=>T(t),className:"relative aspect-square overflow-hidden rounded-lg border-2 transition-all ".concat(P===t?"border-brand-purple-600 ring-2 ring-brand-purple-600 ring-offset-2":"border-gray-200 hover:border-gray-300"),children:(0,a.jsx)(d.default,{src:null!==(r=e.url)&&void 0!==r?r:p,alt:"".concat(k.name," ").concat(t+1),fill:!0,className:"object-cover",fallbackSrc:p})},null!==(l=e.id)&&void 0!==l?l:t)})})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-2 flex flex-col gap-1 text-sm text-gray-600 md:flex-row md:items-center md:gap-2",children:[(0,a.jsx)("span",{children:null!==(w=k.brandName)&&void 0!==w?w:"Sản phẩm chuy\xean nghiệp"}),er&&(0,a.jsxs)("span",{className:"text-sm font-medium text-brand-purple-600",children:["SKU: ",er]}),S&&(0,a.jsx)("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:G?"Đ\xe3 chọn biến thể":"Chọn biến thể để xem chi tiết"})]}),(0,a.jsx)("h1",{className:"mb-4 break-words text-2xl font-bold text-gray-900 sm:text-3xl",children:ea}),(0,a.jsxs)("div",{className:"mb-4 flex items-center gap-2",children:[(0,a.jsx)("div",{className:"flex items-center",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)(n.nae,{className:"h-5 w-5 ".concat(t<Math.round(k.rating||5)?"fill-yellow-400 text-yellow-400":"text-gray-300")},t))}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:es})]}),(0,a.jsxs)("div",{className:"mb-6 flex items-baseline gap-3",children:[(0,a.jsx)("span",{className:"text-3xl font-bold text-gray-900",children:x(null!=Q?Q:J)}),$&&Q&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"text-xl text-gray-500 line-through",children:x($)}),(0,a.jsxs)("span",{className:"text-sm font-semibold text-red-600",children:["Tiết kiệm ",Y,"%"]})]})]}),S&&q.length>0&&(0,a.jsxs)("div",{className:"mb-6 space-y-4 rounded-lg border border-gray-200 p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Chọn biến thể sản phẩm"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Nhấn để chọn hoặc bỏ chọn. C\xe1c t\xf9y chọn sẽ tự động lọc để lu\xf4n tạo được biến thể hợp lệ."}),q.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-medium uppercase text-gray-500",children:e.name}),(0,a.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:e.values.map(t=>{let r=I[e.name]===t,l=ee(e.name,t);return(0,a.jsx)("button",{type:"button",onClick:()=>K(e.name,t),disabled:l,className:"rounded-full border px-4 py-2 text-sm transition ".concat(r?"border-brand-purple-600 bg-brand-purple-50 text-brand-purple-700 shadow-sm":"border-gray-300 text-gray-700 hover:border-brand-purple-400 hover:text-brand-purple-600"," ").concat(l?"cursor-not-allowed opacity-40 grayscale":""),children:t},t)})})]},e.name)),!G&&(0,a.jsx)("div",{className:"rounded-md bg-gray-50 p-3 text-sm text-gray-600",children:B.length>1&&Object.keys(I).length>0?(0,a.jsxs)("span",{children:["Đang c\xf3 ",B.length," biến thể khả dụng. Chọn th\xeam t\xf9y chọn để x\xe1c định ch\xednh x\xe1c."]}):1===B.length?(0,a.jsx)("span",{children:"Chọn th\xeam t\xf9y chọn để x\xe1c nhận biến thể."}):(0,a.jsx)("span",{children:"Vui l\xf2ng chọn c\xe1c t\xf9y chọn để t\xecm biến thể ph\xf9 hợp."})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(c.default,{productId:k.id,variantId:null!=H?H:void 0,name:ea,price:ei,image:ec,quantity:A,fullWidth:!0,size:"lg",disabled:S&&!G||Z<=0}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{className:"flex flex-1 items-center justify-center gap-2 rounded-md border border-gray-300 px-4 py-3 text-gray-700 hover:bg-gray-50",children:"Mua ngay"}),(0,a.jsxs)("div",{className:"relative",ref:V,children:[(0,a.jsx)("button",{onClick:ed,className:"flex items-center justify-center gap-2 rounded-md border border-gray-300 px-4 py-3 text-gray-700 hover:bg-gray-50",children:(0,a.jsx)(n.PMT,{className:"h-5 w-5"})}),R&&(0,a.jsx)("div",{className:"absolute right-0 top-full z-50 mt-2 w-48 rounded-lg border border-gray-200 bg-white shadow-lg",children:(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsxs)("button",{onClick:em,className:"flex w-full items-center gap-3 px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50",children:[(0,a.jsx)(n.C3L,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Sao ch\xe9p link"})]}),(0,a.jsxs)("button",{onClick:eu,className:"flex w-full items-center gap-3 px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50",children:[(0,a.jsx)(n.Bsb,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Chia sẻ Facebook"})]}),(0,a.jsxs)("button",{onClick:eh,className:"flex w-full items-center gap-3 px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50",children:[(0,a.jsx)(n.Ccr,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Chia sẻ Twitter"})]})]})})]})]})]}),(0,a.jsx)("div",{className:"mt-4 flex items-center gap-4 text-sm text-gray-600",children:S?G?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"font-medium text-gray-900",children:Z>0?"C\xf2n h\xe0ng":"Hết h\xe0ng"}),(0,a.jsxs)("span",{children:["Số lượng sẵn c\xf3: ",Math.max(Z,0)]})]}):(0,a.jsx)("span",{className:"font-medium text-gray-900",children:"Chọn biến thể để xem t\xecnh trạng tồn kho"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"font-medium text-gray-900",children:Z>0?"C\xf2n h\xe0ng":"Hết h\xe0ng"}),(0,a.jsxs)("span",{children:["Số lượng sẵn c\xf3: ",Math.max(Z,0)]})]})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-3 block text-sm font-medium text-gray-900",children:"Số lượng"}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsxs)("div",{className:"flex items-center rounded-md border border-gray-300",children:[(0,a.jsx)("button",{onClick:()=>E(e=>Math.max(1,Math.min(e-1,Z>0?Z:1))),className:"px-4 py-2 text-gray-600 hover:bg-gray-50",children:"−"}),(0,a.jsx)("input",{type:"number",value:A,min:1,max:Z>0?Z:void 0,onChange:e=>{let t=parseInt(e.target.value,10),r=Number.isFinite(t)?t:1;E(Z>0?Math.min(Math.max(1,r),Z):1)},className:"w-16 border-x border-gray-300 py-2 text-center"}),(0,a.jsx)("button",{onClick:()=>E(e=>Z<=0?1:Math.min(e+1,Z)),className:"px-4 py-2 text-gray-600 hover:bg-gray-50",children:"+"})]})})]}),en.length>0&&(0,a.jsxs)("div",{className:"rounded-lg border border-gray-200 p-4",children:[(0,a.jsx)("h3",{className:"mb-3 text-sm font-semibold text-gray-900",children:"Th\xf4ng số sản phẩm"}),(0,a.jsx)("dl",{className:"grid grid-cols-1 gap-3 text-sm text-gray-700 sm:grid-cols-2",children:en.map(e=>(0,a.jsxs)("div",{className:"flex flex-col rounded bg-gray-50 p-3",children:[(0,a.jsx)("dt",{className:"text-xs uppercase tracking-wide text-gray-500",children:e.name}),(0,a.jsx)("dd",{className:"mt-1",children:e.value})]},e.id))})]})]})]}),(0,a.jsxs)("div",{className:"mt-12",children:[(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex gap-8",children:[(0,a.jsx)("button",{onClick:()=>_("details"),className:"border-b-2 pb-4 text-sm font-medium transition-colors ".concat("details"===L?"border-brand-purple-600 text-brand-purple-600":"border-transparent text-gray-600 hover:text-gray-900"),children:"Chi tiết"}),(0,a.jsx)("button",{onClick:()=>_("reviews"),className:"border-b-2 pb-4 text-sm font-medium transition-colors ".concat("reviews"===L?"border-brand-purple-600 text-brand-purple-600":"border-transparent text-gray-600 hover:text-gray-900"),children:"Đ\xe1nh gi\xe1 từ kh\xe1ch h\xe0ng"})]})}),(0,a.jsxs)("div",{className:"mt-8",children:["details"===L&&(0,a.jsx)("div",{className:"prose max-w-none",children:(()=>{if(!k.description)return(0,a.jsx)("p",{className:"text-gray-600",children:"M\xf4 tả sản phẩm đang được cập nhật. Vui l\xf2ng li\xean hệ hỗ trợ nếu bạn cần th\xeam th\xf4ng tin chi tiết."});if(/<\/?[a-z][\s\S]*>/i.test(k.description)){let e=function(e,t){var r,a,l,n,s,i;if(!e||"string"!=typeof e)return"";let c={ALLOWED_TAGS:["p","br","strong","em","u","s","h1","h2","h3","h4","h5","h6","ul","ol","li","blockquote","pre","code","div","span","section","article"],ALLOWED_ATTR:["class","id","style"]};return(null==t?void 0:t.allowImages)&&(null===(r=c.ALLOWED_TAGS)||void 0===r||r.push("img"),null===(a=c.ALLOWED_ATTR)||void 0===a||a.push("src","alt","width","height","loading")),(null==t?void 0:t.allowLinks)&&(null===(l=c.ALLOWED_TAGS)||void 0===l||l.push("a"),null===(n=c.ALLOWED_ATTR)||void 0===n||n.push("href","target","rel"),c.ADD_ATTR=["target"],c.ADD_URI_SAFE_ATTR=["href"]),(null==t?void 0:t.allowScripts)&&(null===(s=c.ALLOWED_TAGS)||void 0===s||s.push("script"),null===(i=c.ALLOWED_ATTR)||void 0===i||i.push("src","async","defer","type","id")),u().sanitize(e,c)}(k.description.replace(/src="([^"]+)"/g,(e,t)=>'src="'.concat(t.replace(/\\/g,"/"),'"')),{allowImages:!0,allowLinks:!0,allowScripts:!1});return(0,a.jsx)("div",{className:"prose max-w-none text-gray-700",dangerouslySetInnerHTML:{__html:e}})}return(0,a.jsx)("p",{className:"whitespace-pre-line text-gray-700",children:k.description})})()}),"reviews"===L&&(0,a.jsx)("div",{className:"rounded-lg bg-gray-100 p-6 text-gray-600",children:(0,a.jsx)("p",{children:"T\xednh năng đ\xe1nh gi\xe1 sẽ sớm ra mắt."})})]})]}),el.length>0&&(0,a.jsxs)("div",{className:"mt-16",children:[(0,a.jsx)("h2",{className:"mb-8 text-2xl font-bold text-gray-900",children:"Sản phẩm li\xean quan"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:el.map(e=>(0,a.jsx)(o.Z,{product:e},e.id))})]})]})})}function b(e){var t,r;return null!==(r=null===(t=e.images[0])||void 0===t?void 0:t.url)&&void 0!==r?r:p}},3276:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var a=r(7437),l=r(7648);function n(e){let{items:t,className:r=""}=e;return(0,a.jsx)("nav",{className:"flex ".concat(r),"aria-label":"Breadcrumb",children:(0,a.jsx)("ol",{className:"flex flex-wrap items-center gap-x-2 gap-y-1 text-sm",children:t.map((e,r)=>(0,a.jsxs)("li",{className:"flex items-center",children:[r>0&&(0,a.jsx)("svg",{className:"mx-2 h-4 w-4 shrink-0 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),e.href&&r<t.length-1?(0,a.jsx)(l.default,{href:e.href,className:"break-words text-gray-600 hover:text-brand-purple-600",children:e.label}):(0,a.jsx)("span",{className:"break-words font-medium text-gray-900",children:e.label})]},r))})})}}},function(e){e.O(0,[9956,2972,5878,9064,5883,2289,806,2971,2117,1744],function(){return e(e.s=582)}),_N_E=e.O()}]);