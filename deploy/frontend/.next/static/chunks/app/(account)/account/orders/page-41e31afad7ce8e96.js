(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5465],{6375:function(e,t,r){Promise.resolve().then(r.bind(r,1097))},1097:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f},dynamic:function(){return u}});var s=r(7437),a=r(2265),n=r(3145),i=r(7996),c=r(2709),l=r(3276),o=r(9693),d=r(9064);let u="force-dynamic",p=e=>({pending:"bg-yellow-100 text-yellow-800",processing:"bg-blue-100 text-blue-800",shipped:"bg-purple-100 text-purple-800",delivered:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800",refunded:"bg-gray-100 text-gray-800"})[e],h=e=>({pending:"Chờ xử l\xfd",processing:"Đang xử l\xfd",shipped:"Đ\xe3 gửi h\xe0ng",delivered:"Đ\xe3 giao h\xe0ng",cancelled:"Đ\xe3 hủy",refunded:"Đ\xe3 ho\xe0n tiền"})[e]||e,m=e=>{let t=new Date(e);return new Intl.DateTimeFormat("vi-VN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Ho_Chi_Minh"}).format(t)},g=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e);function f(){let[e,t]=(0,a.useState)([]),[r,u]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{(async()=>{try{let e=await (0,o.AU)();t(e)}catch(t){var e;console.error("Failed to fetch orders:",t),(null===(e=t.response)||void 0===e?void 0:e.status)===401?d.ZP.error("Vui l\xf2ng đăng nhập để xem đơn h\xe0ng"):d.ZP.error("Kh\xf4ng thể tải danh s\xe1ch đơn h\xe0ng")}finally{u(!1)}})()},[]),r)?(0,s.jsx)("div",{className:"card p-6",children:(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-brand-purple-600 border-t-transparent"})})}):(0,s.jsxs)("div",{children:[(0,s.jsx)(l.Z,{items:[{label:"Trang chủ",href:"/"},{label:"T\xe0i khoản",href:"/account"},{label:"Đơn h\xe0ng",href:"/account/orders"}],className:"mb-6"}),(0,s.jsxs)("div",{className:"card p-6",children:[(0,s.jsx)("div",{className:"mb-6 flex items-center justify-between",children:(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Đơn h\xe0ng của t\xf4i"})}),0===e.length?(0,s.jsxs)("div",{className:"py-12 text-center",children:[(0,s.jsx)(i.zFh,{className:"mx-auto mb-4 h-16 w-16 text-gray-400"}),(0,s.jsx)("h3",{className:"mb-2 text-lg font-semibold text-gray-900",children:"Chưa c\xf3 đơn h\xe0ng n\xe0o"}),(0,s.jsx)("p",{className:"mb-6 text-gray-600",children:"Bạn chưa c\xf3 đơn h\xe0ng n\xe0o. H\xe3y bắt đầu mua sắm ngay!"}),(0,s.jsx)(c.Z,{href:"/products",size:"lg",children:"Mua sắm ngay"})]}):(0,s.jsx)("div",{className:"space-y-6",children:e.map(r=>(0,s.jsxs)("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white transition-shadow hover:shadow-md",children:[(0,s.jsx)("div",{className:"border-b border-gray-200 bg-gray-50 px-6 py-4",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"M\xe3 đơn h\xe0ng"}),(0,s.jsx)("p",{className:"font-semibold text-gray-900",children:r.orderNumber})]}),(0,s.jsx)("div",{className:"h-8 w-px bg-gray-300"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,s.jsx)(i.vlc,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:m(r.createdAt)})]}),(0,s.jsx)("div",{className:"h-8 w-px bg-gray-300"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,s.jsx)(i.zFh,{className:"h-4 w-4"}),(0,s.jsxs)("span",{children:[r.items.length," sản phẩm"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("span",{className:"rounded-full px-3 py-1 text-xs font-semibold ".concat(p(r.status)),children:h(r.status)}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Tổng tiền"}),(0,s.jsx)("p",{className:"text-lg font-bold text-gray-900",children:g(r.total)})]})]})]})}),(0,s.jsx)("div",{className:"px-6 py-4",children:(0,s.jsx)("div",{className:"space-y-4",children:r.items.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"relative h-16 w-16 flex-shrink-0 overflow-hidden rounded-lg bg-gray-100",children:(0,s.jsx)(n.default,{src:e.productImage||"/images/placeholder-image.svg",alt:e.productName,fill:!0,className:"object-cover"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900",children:e.productName}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Số lượng: ",e.quantity," \xd7 ",g(e.price)]})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsx)("p",{className:"font-semibold text-gray-900",children:g(e.total)})})]},e.id))})}),(0,s.jsx)("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,s.jsxs)(c.Z,{href:"/account/orders/".concat(r.id),variant:"outline",size:"sm",children:[(0,s.jsx)(i.rDJ,{className:"mr-2 h-4 w-4"}),"Xem chi tiết"]}),"delivered"===r.status&&(0,s.jsx)(c.Z,{variant:"outline",size:"sm",children:"Mua lại"}),"pending"===r.status&&(0,s.jsx)(c.Z,{variant:"danger",size:"sm",onClick:async()=>{if(confirm("Bạn c\xf3 chắc chắn muốn hủy đơn h\xe0ng n\xe0y?"))try{await (0,o.sl)(r.id),t(e.map(e=>e.id===r.id?{...e,status:"cancelled"}:e)),d.ZP.success("Hủy đơn h\xe0ng th\xe0nh c\xf4ng!")}catch(t){var s,a;console.error("Cancel order error:",t);let e=(null==t?void 0:null===(a=t.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)||(null==t?void 0:t.message)||"Hủy đơn h\xe0ng thất bại. Vui l\xf2ng thử lại.";d.ZP.error(e)}},children:"Hủy đơn"})]})})]},r.id))})]})]})}},3276:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var s=r(7437),a=r(7648);function n(e){let{items:t,className:r=""}=e;return(0,s.jsx)("nav",{className:"flex ".concat(r),"aria-label":"Breadcrumb",children:(0,s.jsx)("ol",{className:"flex flex-wrap items-center gap-x-2 gap-y-1 text-sm",children:t.map((e,r)=>(0,s.jsxs)("li",{className:"flex items-center",children:[r>0&&(0,s.jsx)("svg",{className:"mx-2 h-4 w-4 shrink-0 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),e.href&&r<t.length-1?(0,s.jsx)(a.default,{href:e.href,className:"break-words text-gray-600 hover:text-brand-purple-600",children:e.label}):(0,s.jsx)("span",{className:"break-words font-medium text-gray-900",children:e.label})]},r))})})}},2709:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var s=r(7437),a=r(7648),n=r(6857);function i(e){let{children:t,variant:r="primary",size:i="md",isLoading:c=!1,fullWidth:l=!1,className:o,disabled:d,href:u,...p}=e,h=(0,n.cn)("btn",{primary:"btn-primary",secondary:"btn-secondary",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-gray-500",ghost:"bg-transparent text-brand-purple-600 hover:bg-brand-purple-50 focus:ring-brand-purple-500",danger:"bg-error text-white hover:bg-[#98131b] focus:ring-error"}[r],{sm:"btn-sm",md:"btn-md",lg:"btn-lg"}[i],l&&"w-full",(d||c)&&"opacity-50 cursor-not-allowed",o),m=c?(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsxs)("svg",{className:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang tải..."]}):t;return u?(0,s.jsx)(a.default,{href:u,legacyBehavior:!0,passHref:!0,children:(0,s.jsx)("a",{className:h,children:m})}):(0,s.jsx)("button",{className:h,disabled:d||c,...p,children:m})}},1971:function(e,t,r){"use strict";r.d(t,{f8:function(){return u},kG:function(){return o},uD:function(){return p}}),r(257);let s="/api",a=e=>e?e.replace(/\/+$/,""):"",n=e=>e?e.startsWith("/")?e:"/".concat(e):"",i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=a(e);return t?"".concat(r).concat(n(t)):r},c=()=>{let e=a("https://ecommerce-api.banyco.vn/api");if(e)return e.endsWith("/api")?e:i(e,s);let t="ecommerce-api.banyco.vn";if(t){let e=window.location.protocol;return"".concat(e,"//").concat(t).concat(s)}{let{protocol:e,hostname:t}=window.location;return i("".concat(e,"//").concat(t).concat(":".concat("443")),s)}},l=e=>a(e).replace(/\/api$/,""),o=()=>c(),d=()=>l(c()),u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return i(c(),e)},p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return i(d(),e)}},3405:function(e,t,r){"use strict";r.d(t,{z:function(){return i}});var s=r(3464),a=r(1971);let n=s.Z.create({baseURL:(0,a.kG)(),timeout:3e4,headers:{"Content-Type":"application/json"}});function i(e){if(s.Z.isAxiosError(e)){if(e.response){let t=e.response.data;return(null==t?void 0:t.code)==="INSUFFICIENT_STOCK"?'Sản phẩm "'.concat(t.productName,'" kh\xf4ng đủ số lượng. C\xf2n lại: ').concat(t.availableStock,", Bạn y\xeau cầu: ").concat(t.requestedQuantity):(null==t?void 0:t.error)||(null==t?void 0:t.message)||"Đ\xe3 xảy ra lỗi khi xử l\xfd y\xeau cầu"}if(e.request)return"Kh\xf4ng c\xf3 phản hồi từ server. Vui l\xf2ng kiểm tra kết nối của bạn."}return"Đ\xe3 xảy ra lỗi kh\xf4ng mong muốn"}n.interceptors.request.use(e=>{{let t=localStorage.getItem("accessToken");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,async e=>{var t;let r=e.config;if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&!r._retry){r._retry=!0;try{let e=localStorage.getItem("refreshToken");if(e){let{accessToken:t}=(await s.Z.post("".concat((0,a.kG)(),"/public/auth/refresh"),{refreshToken:e})).data.data;return localStorage.setItem("accessToken",t),r.headers&&(r.headers.Authorization="Bearer ".concat(t)),n(r)}}catch(e){return localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.href="/login",Promise.reject(e)}}return Promise.reject(e)}),t.Z=n},2780:function(e,t,r){"use strict";r.d(t,{P:function(){return s}});let s={AUTH:{LOGIN:"/auth/login",REGISTER:"/auth/register",LOGOUT:"/auth/logout",REFRESH:"/auth/refresh",VERIFY_EMAIL:"/auth/verify-email",FORGOT_PASSWORD:"/auth/forgot-password",RESET_PASSWORD:"/auth/reset-password",ME:"/auth/me"},PRODUCTS:{LIST:"/products",DETAIL:e=>"/products/".concat(e),SEARCH:"/products/search",FEATURED:"/products/featured",BEST_SELLERS:"/products/best-sellers",NEW_ARRIVALS:"/products/new-arrivals",RELATED:e=>"/products/".concat(e,"/related"),REVIEWS:e=>"/products/".concat(e,"/reviews")},CATEGORIES:{LIST:"/product-categories",DETAIL:e=>"/product-categories/slug/".concat(e),TREE:"/product-categories/tree",PRODUCTS:e=>"/product-categories/".concat(e,"/products")},BRANDS:{LIST:"/brands",DETAIL:e=>"/brands/slug/".concat(e),PRODUCTS:e=>"/brands/".concat(e,"/products")},CART:{GET:"/public/cart",ADD:"/public/cart/add",UPDATE:"/public/cart/update",REMOVE:"/public/cart/remove",CLEAR:"/public/cart/clear",APPLY_PROMO:"/public/cart/promo"},ORDERS:{LIST:"/public/orders",DETAIL:e=>"/public/orders/".concat(e),CREATE:"/orders",CANCEL:e=>"/public/orders/".concat(e,"/cancel")},USER:{PROFILE:"/public/user/profile",UPDATE_PROFILE:"/public/user/profile",ADDRESSES:"/public/user/addresses",ADD_ADDRESS:"/public/user/addresses",UPDATE_ADDRESS:e=>"/public/user/addresses/".concat(e),DELETE_ADDRESS:e=>"/public/user/addresses/".concat(e),WISHLIST:"/public/user/wishlist",ADD_TO_WISHLIST:"/public/user/wishlist/add",REMOVE_FROM_WISHLIST:"/public/user/wishlist/remove"},SEARCH:{PRODUCTS:"/search/products",SUGGESTIONS:"/search/suggestions"},NEWSLETTER:{SUBSCRIBE:"/newsletter/subscribe"},CONTACTS:{SUBMIT:"/contacts"},ANALYTICS:{TRACK:"/analytics/track"},POSTS:{LIST:"/public/posts",DETAIL:e=>"/public/posts/".concat(e),RELATED:e=>"/public/posts/".concat(e,"/related")},ABOUT:{SECTIONS:"/about-sections",SECTION_BY_KEY:e=>"/about-sections/key/".concat(e)},TRACKING:{ACTIVE_SCRIPTS:"/tracking-scripts/active"}}},9693:function(e,t,r){"use strict";r.d(t,{AU:function(){return i},G7:function(){return c},LV:function(){return l},sl:function(){return o}});var s=r(3405),a=r(2780);let n=e=>({id:e.id,orderNumber:e.order_number,userId:e.customer_id||"",items:e.items.map(e=>({id:e.id,productId:e.product_id,productName:e.product_name,productImage:e.product_image_url||"/images/placeholder-image.svg",variantId:e.variant_info?String(e.variant_info.id||""):void 0,variantName:e.variant_info?String(e.variant_info.name||""):void 0,sku:e.product_sku||"",quantity:e.quantity,price:e.unit_price,total:e.total_price})),status:e.status||"pending",paymentStatus:e.payment_status||"pending",shippingAddress:{id:e.shipping_address.addressLine1||"",userId:e.customer_id||"",firstName:e.shipping_address.firstName,lastName:e.shipping_address.lastName,company:e.shipping_address.company,addressLine1:e.shipping_address.addressLine1,addressLine2:e.shipping_address.addressLine2,city:e.shipping_address.city,state:e.shipping_address.state,postalCode:e.shipping_address.postalCode,country:e.shipping_address.country,phone:e.shipping_address.phone,isDefault:!1,type:"shipping"},billingAddress:{id:e.billing_address.addressLine1||"",userId:e.customer_id||"",firstName:e.billing_address.firstName,lastName:e.billing_address.lastName,company:e.billing_address.company,addressLine1:e.billing_address.addressLine1,addressLine2:e.billing_address.addressLine2,city:e.billing_address.city,state:e.billing_address.state,postalCode:e.billing_address.postalCode,country:e.billing_address.country,phone:e.billing_address.phone,isDefault:!1,type:"billing"},shippingMethod:e.shipping_method||"",paymentMethod:e.payment_method||"",subtotal:e.subtotal,shipping:e.shipping_cost,tax:e.tax_amount,discount:e.discount_amount,total:e.total,trackingNumber:e.tracking_number||void 0,notes:e.notes||void 0,createdAt:e.created_at,updatedAt:e.updated_at}),i=async()=>(await s.Z.get(a.P.ORDERS.LIST)).data.data.map(n),c=async e=>n((await s.Z.get(a.P.ORDERS.DETAIL(e))).data.data),l=async e=>{try{let t=await s.Z.post(a.P.ORDERS.CREATE,e),r="data"in t.data?t.data.data:t.data;return n(r)}catch(e){throw console.error("[API] Error creating order:",e),console.error("[API] Error response:",e instanceof Error?e.message:String(e)),e}},o=async e=>n((await s.Z.post(a.P.ORDERS.CANCEL(e))).data.data)},6857:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var s=r(1994);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.W)(t)}},3145:function(e,t,r){"use strict";r.d(t,{default:function(){return a.a}});var s=r(8461),a=r.n(s)},8461:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return l},getImageProps:function(){return c}});let s=r(7043),a=r(5346),n=r(5878),i=s._(r(5084));function c(e){let{props:t}=(0,a.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let l=n.Image},1994:function(e,t,r){"use strict";function s(){for(var e,t,r=0,s="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=function e(t){var r,s,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t){if(Array.isArray(t)){var n=t.length;for(r=0;r<n;r++)t[r]&&(s=e(t[r]))&&(a&&(a+=" "),a+=s)}else for(s in t)t[s]&&(a&&(a+=" "),a+=s)}return a}(e))&&(s&&(s+=" "),s+=t);return s}r.d(t,{W:function(){return s}})}},function(e){e.O(0,[9956,2972,5878,9064,9502,2971,2117,1744],function(){return e(e.s=6375)}),_N_E=e.O()}]);