(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5812],{1183:function(e,s,r){Promise.resolve().then(r.bind(r,6947))},6947:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return p},dynamic:function(){return h}});var t=r(7437),a=r(2265),n=r(9501),l=r(7996),i=r(2709),o=r(7194),c=r(3276),d=r(9064),u=r(6018);let h="force-dynamic";function p(){var e,s,r,h,p,m,g,v;let[b,x]=(0,a.useState)([]),[f,y]=(0,a.useState)(!0),[E,N]=(0,a.useState)(!1),[S,T]=(0,a.useState)(null),[j,R]=(0,a.useState)(!1),{register:A,handleSubmit:I,reset:C,formState:{errors:D}}=(0,n.cI)({mode:"onSubmit",reValidateMode:"onChange",defaultValues:{country:"Việt Nam",isDefault:!1,type:"both"}});(0,a.useEffect)(()=>{(async()=>{y(!0);try{let e=await (0,u.cl)();x(e||[])}catch(n){var e,s,r,t,a;console.error("[AddressesPage] Failed to fetch addresses:",n),console.error("[AddressesPage] Error details:",{message:null==n?void 0:n.message,response:null==n?void 0:null===(e=n.response)||void 0===e?void 0:e.data,status:null==n?void 0:null===(s=n.response)||void 0===s?void 0:s.status}),(null===(r=n.response)||void 0===r?void 0:r.status)===401?d.ZP.error("Vui l\xf2ng đăng nhập để xem địa chỉ"):((null===(t=n.response)||void 0===t?void 0:t.status)===404||(null===(a=n.response)||void 0===a?void 0:a.status)===500&&console.error("[AddressesPage] Server error when fetching addresses"),x([]))}finally{y(!1)}})()},[]);let P=async e=>{R(!0);try{if(S){let s=await (0,u.y3)(S,e);x(b.map(e=>e.id===S?s:e)),d.ZP.success("Cập nhật địa chỉ th\xe0nh c\xf4ng!")}else{let s=await (0,u.p6)(e);x([...b,s]),d.ZP.success("Th\xeam địa chỉ th\xe0nh c\xf4ng!")}C({country:"Việt Nam",isDefault:!1,type:"both"}),N(!1),T(null)}catch(u){var s,r,t,a,n,l,i,o,c,h,p;console.error("[AddressesPage] ========== FORM SUBMIT ERROR =========="),console.error("[AddressesPage] Save address error:",u),console.error("[AddressesPage] Error details:",{message:null==u?void 0:u.message,response:null==u?void 0:null===(s=u.response)||void 0===s?void 0:s.data,status:null==u?void 0:null===(r=u.response)||void 0===r?void 0:r.status,url:null==u?void 0:null===(t=u.config)||void 0===t?void 0:t.url,baseURL:null==u?void 0:null===(a=u.config)||void 0===a?void 0:a.baseURL});let e="C\xf3 lỗi xảy ra. Vui l\xf2ng thử lại.";(null==u?void 0:null===(n=u.response)||void 0===n?void 0:n.data)?u.response.data.error?"string"==typeof u.response.data.error?e=u.response.data.error:u.response.data.error.message&&(e=u.response.data.error.message):u.response.data.message?e=u.response.data.message:"string"==typeof u.response.data&&(e=u.response.data):(null==u?void 0:u.message)&&(e=u.message),(null==u?void 0:u.code)==="ERR_NETWORK"||(null==u?void 0:u.message)==="Network Error"?e="Kh\xf4ng thể kết nối đến server. Vui l\xf2ng kiểm tra xem backend server đ\xe3 chạy chưa.":(null==u?void 0:u.code)==="ERR_CONNECTION_REFUSED"?e="Kết nối bị từ chối. Vui l\xf2ng kiểm tra xem backend server đ\xe3 chạy chưa.":(null==u?void 0:null===(l=u.response)||void 0===l?void 0:l.status)===401?e="Vui l\xf2ng đăng nhập để th\xeam địa chỉ":(null==u?void 0:null===(i=u.response)||void 0===i?void 0:i.status)===500?e=(null==u?void 0:null===(p=u.response)||void 0===p?void 0:null===(h=p.data)||void 0===h?void 0:h.error)?"Lỗi server: ".concat(u.response.data.error):"Lỗi server khi th\xeam địa chỉ. Vui l\xf2ng kiểm tra lại th\xf4ng tin v\xe0 thử lại.":(null==u?void 0:null===(o=u.response)||void 0===o?void 0:o.status)===400?e=e||"Dữ liệu kh\xf4ng hợp lệ. Vui l\xf2ng kiểm tra lại th\xf4ng tin.":(null==u?void 0:null===(c=u.response)||void 0===c?void 0:c.status)===404&&(e="API endpoint kh\xf4ng tồn tại. Vui l\xf2ng li\xean hệ hỗ trợ."),console.error("[AddressesPage] Final error message:",e),console.error("[AddressesPage] Error code:",null==u?void 0:u.code),console.error("[AddressesPage] Full error:",u),d.ZP.error(e)}finally{R(!1)}},L=e=>{C(e),T(e.id),N(!0)},k=async e=>{if(confirm("Bạn c\xf3 chắc chắn muốn x\xf3a địa chỉ n\xe0y?"))try{await (0,u._N)(e),x(b.filter(s=>s.id!==e)),d.ZP.success("X\xf3a địa chỉ th\xe0nh c\xf4ng!")}catch(t){var s,r;console.error("Delete address error:",t);let e=(null==t?void 0:null===(r=t.response)||void 0===r?void 0:null===(s=r.data)||void 0===s?void 0:s.message)||(null==t?void 0:t.message)||"X\xf3a địa chỉ thất bại. Vui l\xf2ng thử lại.";d.ZP.error(e)}};return f?(0,t.jsx)("div",{className:"card p-6",children:(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-brand-purple-600 border-t-transparent"})})}):(0,t.jsxs)("div",{children:[(0,t.jsx)(c.Z,{items:[{label:"Trang chủ",href:"/"},{label:"T\xe0i khoản",href:"/account"},{label:"Địa chỉ",href:"/account/addresses"}],className:"mb-6"}),(0,t.jsxs)("div",{className:"card p-6",children:[(0,t.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Địa chỉ của t\xf4i"}),!E&&(0,t.jsxs)(i.Z,{onClick:()=>N(!0),children:[(0,t.jsx)(l.OvN,{className:"mr-2 h-4 w-4"}),"Th\xeam địa chỉ mới"]})]}),E&&(0,t.jsxs)("div",{className:"mb-8 rounded-lg border border-gray-200 bg-gray-50 p-6",children:[(0,t.jsx)("h2",{className:"mb-6 text-xl font-semibold text-gray-900",children:S?"Chỉnh sửa địa chỉ":"Th\xeam địa chỉ mới"}),(0,t.jsxs)("form",{onSubmit:I(P,e=>{console.error("[AddressesPage] ========== VALIDATION ERRORS =========="),console.error("[AddressesPage] Form validation errors:",e),console.error("[AddressesPage] Form has errors, cannot submit");let s=Object.values(e)[0];(null==s?void 0:s.message)?d.ZP.error(s.message):d.ZP.error("Vui l\xf2ng điền đầy đủ th\xf4ng tin bắt buộc")}),className:"space-y-4",noValidate:!0,children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,t.jsx)(o.Z,{label:"Họ",type:"text",error:null===(e=D.lastName)||void 0===e?void 0:e.message,required:!0,...A("lastName",{required:"Họ l\xe0 bắt buộc"})}),(0,t.jsx)(o.Z,{label:"T\xean",type:"text",error:null===(s=D.firstName)||void 0===s?void 0:s.message,required:!0,...A("firstName",{required:"T\xean l\xe0 bắt buộc"})})]}),(0,t.jsx)(o.Z,{label:"C\xf4ng ty (t\xf9y chọn)",type:"text",...A("company")}),(0,t.jsx)(o.Z,{label:"Địa chỉ",type:"text",error:null===(r=D.addressLine1)||void 0===r?void 0:r.message,required:!0,...A("addressLine1",{required:"Địa chỉ l\xe0 bắt buộc"})}),(0,t.jsx)(o.Z,{label:"Địa chỉ 2 (t\xf9y chọn)",type:"text",...A("addressLine2")}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[(0,t.jsx)(o.Z,{label:"Th\xe0nh phố",type:"text",error:null===(h=D.city)||void 0===h?void 0:h.message,required:!0,...A("city",{required:"Th\xe0nh phố l\xe0 bắt buộc"})}),(0,t.jsx)(o.Z,{label:"Tỉnh/Th\xe0nh",type:"text",error:null===(p=D.state)||void 0===p?void 0:p.message,required:!0,...A("state",{required:"Tỉnh/Th\xe0nh l\xe0 bắt buộc"})}),(0,t.jsx)(o.Z,{label:"M\xe3 bưu điện",type:"text",error:null===(m=D.postalCode)||void 0===m?void 0:m.message,required:!0,...A("postalCode",{required:"M\xe3 bưu điện l\xe0 bắt buộc"})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,t.jsx)(o.Z,{label:"Quốc gia",type:"text",error:null===(g=D.country)||void 0===g?void 0:g.message,required:!0,...A("country",{required:"Quốc gia l\xe0 bắt buộc"})}),(0,t.jsx)(o.Z,{label:"Số điện thoại",type:"tel",error:null===(v=D.phone)||void 0===v?void 0:v.message,required:!0,...A("phone",{required:"Số điện thoại l\xe0 bắt buộc"})})]}),(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",...A("isDefault"),className:"mr-2 h-4 w-4 rounded border-gray-300 text-brand-purple-600"}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:"Đặt l\xe0m địa chỉ mặc định"})]})}),(0,t.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,t.jsx)(i.Z,{type:"button",variant:"outline",onClick:()=>{N(!1),T(null),C()},children:"Hủy"}),(0,t.jsxs)(i.Z,{type:"submit",isLoading:j,disabled:j,children:[(0,t.jsx)(l.UgA,{className:"mr-2 h-4 w-4"}),S?"Cập nhật":"Th\xeam địa chỉ"]})]})]})]}),0===b.length?(0,t.jsxs)("div",{className:"py-12 text-center",children:[(0,t.jsx)(l.i63,{className:"mx-auto mb-4 h-16 w-16 text-gray-400"}),(0,t.jsx)("h3",{className:"mb-2 text-lg font-semibold text-gray-900",children:"Chưa c\xf3 địa chỉ n\xe0o"}),(0,t.jsx)("p",{className:"mb-6 text-gray-600",children:"Th\xeam địa chỉ để đơn h\xe0ng được giao nhanh ch\xf3ng hơn."}),(0,t.jsxs)(i.Z,{onClick:()=>N(!0),children:[(0,t.jsx)(l.OvN,{className:"mr-2 h-4 w-4"}),"Th\xeam địa chỉ đầu ti\xean"]})]}):(0,t.jsx)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:b.map(e=>(0,t.jsxs)("div",{className:"rounded-lg border-2 p-6 ".concat(e.isDefault?"border-brand-purple-600 bg-purple-50":"border-gray-200 bg-white"),children:[(0,t.jsxs)("div",{className:"mb-4 flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.i63,{className:"h-5 w-5 text-brand-purple-600"}),e.isDefault&&(0,t.jsx)("span",{className:"rounded-full bg-brand-purple-600 px-2 py-1 text-xs font-semibold text-white",children:"Mặc định"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>L(e),className:"rounded-lg p-2 text-gray-600 hover:bg-gray-100",children:(0,t.jsx)(l.vPQ,{className:"h-4 w-4"})}),(0,t.jsx)("button",{onClick:()=>k(e.id),className:"rounded-lg p-2 text-red-600 hover:bg-red-50",children:(0,t.jsx)(l.Ybf,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"space-y-1 text-sm text-gray-700",children:[(0,t.jsxs)("p",{className:"font-semibold",children:[e.lastName," ",e.firstName]}),e.company&&(0,t.jsx)("p",{children:e.company}),(0,t.jsx)("p",{children:e.addressLine1}),e.addressLine2&&(0,t.jsx)("p",{children:e.addressLine2}),(0,t.jsxs)("p",{children:[e.city,", ",e.state," ",e.postalCode]}),(0,t.jsx)("p",{children:e.country}),(0,t.jsx)("p",{className:"mt-2",children:e.phone})]})]},e.id))})]})]})}},7194:function(e,s,r){"use strict";var t=r(7437),a=r(2265),n=r(6857);let l=(0,a.forwardRef)((e,s)=>{let{label:r,error:l,helperText:i,leftIcon:o,rightIcon:c,className:d,id:u,required:h,...p}=e,m=(0,a.useId)(),g=null!=u?u:m;return(0,t.jsxs)("div",{className:"w-full",children:[r&&(0,t.jsxs)("label",{htmlFor:g,className:"mb-1.5 block text-sm font-medium text-gray-700",children:[r,h&&(0,t.jsx)("span",{className:"ml-1 text-error",children:"*"})]}),(0,t.jsxs)("div",{className:"relative",children:[o&&(0,t.jsx)("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-gray-400",children:o}),(0,t.jsx)("input",{ref:s,id:g,className:(0,n.cn)("input",l&&"input-error",o&&"pl-10",c&&"pr-10",d),required:h,...p}),c&&(0,t.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400",children:c})]}),l&&(0,t.jsx)("p",{className:"mt-1.5 text-sm text-error",children:l}),i&&!l&&(0,t.jsx)("p",{className:"mt-1.5 text-sm text-gray-500",children:i})]})});l.displayName="Input",s.Z=l},1971:function(e,s,r){"use strict";r.d(s,{f8:function(){return u},kG:function(){return c},uD:function(){return h}}),r(257);let t="/api",a=e=>e?e.replace(/\/+$/,""):"",n=e=>e?e.startsWith("/")?e:"/".concat(e):"",l=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=a(e);return s?"".concat(r).concat(n(s)):r},i=()=>{let e=a("https://ecommerce-api.banyco.vn/api");if(e)return e.endsWith("/api")?e:l(e,t);let s="ecommerce-api.banyco.vn";if(s){let e=window.location.protocol;return"".concat(e,"//").concat(s).concat(t)}{let{protocol:e,hostname:s}=window.location;return l("".concat(e,"//").concat(s).concat(":".concat("443")),t)}},o=e=>a(e).replace(/\/api$/,""),c=()=>i(),d=()=>o(i()),u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return l(i(),e)},h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return l(d(),e)}},3405:function(e,s,r){"use strict";r.d(s,{z:function(){return l}});var t=r(3464),a=r(1971);let n=t.Z.create({baseURL:(0,a.kG)(),timeout:3e4,headers:{"Content-Type":"application/json"}});function l(e){if(t.Z.isAxiosError(e)){if(e.response){let s=e.response.data;return(null==s?void 0:s.code)==="INSUFFICIENT_STOCK"?'Sản phẩm "'.concat(s.productName,'" kh\xf4ng đủ số lượng. C\xf2n lại: ').concat(s.availableStock,", Bạn y\xeau cầu: ").concat(s.requestedQuantity):(null==s?void 0:s.error)||(null==s?void 0:s.message)||"Đ\xe3 xảy ra lỗi khi xử l\xfd y\xeau cầu"}if(e.request)return"Kh\xf4ng c\xf3 phản hồi từ server. Vui l\xf2ng kiểm tra kết nối của bạn."}return"Đ\xe3 xảy ra lỗi kh\xf4ng mong muốn"}n.interceptors.request.use(e=>{{let s=localStorage.getItem("accessToken");s&&(e.headers.Authorization="Bearer ".concat(s))}return e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,async e=>{var s;let r=e.config;if((null===(s=e.response)||void 0===s?void 0:s.status)===401&&!r._retry){r._retry=!0;try{let e=localStorage.getItem("refreshToken");if(e){let{accessToken:s}=(await t.Z.post("".concat((0,a.kG)(),"/public/auth/refresh"),{refreshToken:e})).data.data;return localStorage.setItem("accessToken",s),r.headers&&(r.headers.Authorization="Bearer ".concat(s)),n(r)}}catch(e){return localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.href="/login",Promise.reject(e)}}return Promise.reject(e)}),s.Z=n},2780:function(e,s,r){"use strict";r.d(s,{P:function(){return t}});let t={AUTH:{LOGIN:"/auth/login",REGISTER:"/auth/register",LOGOUT:"/auth/logout",REFRESH:"/auth/refresh",VERIFY_EMAIL:"/auth/verify-email",FORGOT_PASSWORD:"/auth/forgot-password",RESET_PASSWORD:"/auth/reset-password",ME:"/auth/me"},PRODUCTS:{LIST:"/products",DETAIL:e=>"/products/".concat(e),SEARCH:"/products/search",FEATURED:"/products/featured",BEST_SELLERS:"/products/best-sellers",NEW_ARRIVALS:"/products/new-arrivals",RELATED:e=>"/products/".concat(e,"/related"),REVIEWS:e=>"/products/".concat(e,"/reviews")},CATEGORIES:{LIST:"/product-categories",DETAIL:e=>"/product-categories/slug/".concat(e),TREE:"/product-categories/tree",PRODUCTS:e=>"/product-categories/".concat(e,"/products")},BRANDS:{LIST:"/brands",DETAIL:e=>"/brands/slug/".concat(e),PRODUCTS:e=>"/brands/".concat(e,"/products")},CART:{GET:"/public/cart",ADD:"/public/cart/add",UPDATE:"/public/cart/update",REMOVE:"/public/cart/remove",CLEAR:"/public/cart/clear",APPLY_PROMO:"/public/cart/promo"},ORDERS:{LIST:"/public/orders",DETAIL:e=>"/public/orders/".concat(e),CREATE:"/orders",CANCEL:e=>"/public/orders/".concat(e,"/cancel")},USER:{PROFILE:"/public/user/profile",UPDATE_PROFILE:"/public/user/profile",ADDRESSES:"/public/user/addresses",ADD_ADDRESS:"/public/user/addresses",UPDATE_ADDRESS:e=>"/public/user/addresses/".concat(e),DELETE_ADDRESS:e=>"/public/user/addresses/".concat(e),WISHLIST:"/public/user/wishlist",ADD_TO_WISHLIST:"/public/user/wishlist/add",REMOVE_FROM_WISHLIST:"/public/user/wishlist/remove"},SEARCH:{PRODUCTS:"/search/products",SUGGESTIONS:"/search/suggestions"},NEWSLETTER:{SUBSCRIBE:"/newsletter/subscribe"},CONTACTS:{SUBMIT:"/contacts"},ANALYTICS:{TRACK:"/analytics/track"},POSTS:{LIST:"/public/posts",DETAIL:e=>"/public/posts/".concat(e),RELATED:e=>"/public/posts/".concat(e,"/related")},ABOUT:{SECTIONS:"/about-sections",SECTION_BY_KEY:e=>"/about-sections/key/".concat(e)},TRACKING:{ACTIVE_SCRIPTS:"/tracking-scripts/active"}}}},function(e){e.O(0,[9956,2972,9064,9502,8036,7927,2971,2117,1744],function(){return e(e.s=1183)}),_N_E=e.O()}]);