(()=>{var e={};e.id=2614,e.ids=[2614],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},12477:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>u,routeModule:()=>g,tree:()=>c}),r(13518),r(20802),r(15334),r(26083),r(19644),r(96560);var a=r(23191),s=r(88716),i=r(37922),l=r.n(i),o=r(95231),n={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>o[e]);r.d(t,n);let c=["",{children:["(shop)",{children:["products",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,13518)),"D:\\PROJECT\\Cursor\\Banyco v2\\Ecommerce\\frontend\\app\\(shop)\\products\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,20802)),"D:\\PROJECT\\Cursor\\Banyco v2\\Ecommerce\\frontend\\app\\(shop)\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,15334)),"D:\\PROJECT\\Cursor\\Banyco v2\\Ecommerce\\frontend\\app\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,26083)),"D:\\PROJECT\\Cursor\\Banyco v2\\Ecommerce\\frontend\\app\\error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,19644)),"D:\\PROJECT\\Cursor\\Banyco v2\\Ecommerce\\frontend\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,96560)),"D:\\PROJECT\\Cursor\\Banyco v2\\Ecommerce\\frontend\\app\\not-found.tsx"]}],u=["D:\\PROJECT\\Cursor\\Banyco v2\\Ecommerce\\frontend\\app\\(shop)\\products\\page.tsx"],d="/(shop)/products/page",p={require:r,loadChunk:()=>Promise.resolve()},g=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/(shop)/products/page",pathname:"/products",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},69395:(e,t,r)=>{Promise.resolve().then(r.bind(r,18e3))},18e3:(e,t,r)=>{"use strict";r.d(t,{default:()=>y});var a=r(10326),s=r(17577),i=r(53465),l=r(89790),o=r(52524),n=r(59577),c=r(59575),u=r(79618),d=r(71473),p=r(35047),g=r(36704);let m=[{id:"0-200000",label:"Dưới 200.000₫"},{id:"200000-500000",label:"200.000₫ - 500.000₫"},{id:"500000-1000000",label:"500.000₫ - 1.000.000₫"},{id:"1000000-2500000",label:"1.000.000₫ - 2.500.000₫"},{id:"2500000-5000000",label:"2.500.000₫ - 5.000.000₫"},{id:"5000000+",label:"Tr\xean 5.000.000₫"}],h=[{id:"in-stock",label:"C\xf2n h\xe0ng"},{id:"out-of-stock",label:"Hết h\xe0ng"}],f=[{id:"on-sale",label:"Đang giảm gi\xe1"},{id:"new",label:"H\xe0ng mới về"},{id:"featured",label:"Nổi bật"},{id:"best-seller",label:"B\xe1n chạy"}],x=e=>{let t;let r=null!==e.comparePrice&&void 0!==e.comparePrice&&e.comparePrice>e.price,a=r?e.comparePrice??e.price:e.price,s=r?e.price:void 0;e.isBestSeller?t="B\xe1n chạy":e.isFeatured&&(t="Nổi bật");let i=e.isVariant??!1,l=e.baseProductId??e.id,o=i?e.id:void 0;return{id:e.id,productId:l,variantId:o,slug:e.slug,name:e.name,price:a,salePrice:s,image:e.thumbnailUrl??"/images/placeholder-product.jpg",rating:e.rating??0,reviewCount:e.reviewCount??0,badge:t,inStock:(e.stock??0)>0}};function y({initialProducts:e,initialMeta:t,categories:r,brands:y,initialState:b}){(0,p.useRouter)(),(0,p.usePathname)();let[v,P]=(0,s.useState)(e.map(x)),[j,C]=(0,s.useState)(t),[_,w]=(0,s.useState)(b.selectedFilters),[S,N]=(0,s.useState)(b.sortBy),[B,E]=(0,s.useState)(b.searchQuery),[q,k]=(0,s.useState)(b.page),[T,R]=(0,s.useState)(!1),[D,M]=(0,s.useState)(!1),J=t.pageSize??24;(0,s.useRef)(!1);let $=(0,s.useMemo)(()=>[{id:"category",title:"Danh mục",options:r.map(e=>({id:e.slug,label:e.name,count:e.productCount??void 0}))},{id:"brand",title:"Thương hiệu",options:y.map(e=>({id:e.slug,label:e.name}))},{id:"price",title:"Khoảng gi\xe1",options:m},{id:"availability",title:"T\xecnh trạng",options:h},{id:"special",title:"Ưu đ\xe3i đặc biệt",options:f}],[y,r]);(0,s.useCallback)(async()=>{R(!0);try{let e=await (0,g.t)({page:q,pageSize:J,q:B,sort:S,category:_.category?.join(","),brand:_.brand?.join(","),price:_.price?.join(","),availability:_.availability?.join(","),special:_.special?.join(",")});P(e.data.map(x)),C(e.meta)}catch(e){console.error("[ProductsPageClient] loadProducts failed",e),P([]),C({total:0,page:1,pageSize:J,totalPages:0})}finally{R(!1)}},[q,J,B,S,_]);let F=(0,s.useMemo)(()=>[{label:"Trang chủ",href:"/"},{label:"Sản phẩm"}],[]);return a.jsx("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"container-custom py-8",children:[a.jsx(c.Z,{items:F,className:"mb-6"}),(0,a.jsxs)("div",{className:"mb-8",children:[a.jsx("h1",{className:"mb-4 text-3xl font-bold text-gray-900",children:"Tất cả sản phẩm"}),a.jsx(n.Z,{value:B,onChange:e=>{E(e),k(1)}})]}),a.jsx("div",{className:"mb-4 lg:hidden",children:(0,a.jsxs)(u.Z,{variant:"outline",onClick:()=>M(!D),className:"w-full",children:[a.jsx(d.Ihx,{className:"mr-2"}),"Bộ lọc"," ",Object.values(_).flat().length>0&&`(${Object.values(_).flat().length})`]})}),(0,a.jsxs)("div",{className:"flex gap-8",children:[a.jsx("aside",{className:`${D?"block":"hidden"} w-full lg:block lg:w-64 lg:flex-shrink-0`,children:a.jsx(l.Z,{filters:$,selectedFilters:_,onFilterChange:(e,t)=>{w(r=>({...r,[e]:t})),k(1)},onClearAll:()=>{w({}),E(""),N("featured"),k(1)}})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("div",{className:"mb-6",children:a.jsx(o.Z,{value:S,onChange:e=>{N(e),k(1)},totalProducts:j.total})}),a.jsx(i.Z,{products:v,loading:T})]})]})]})})}},59575:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var a=r(10326),s=r(90434);function i({items:e,className:t=""}){return a.jsx("nav",{className:`flex ${t}`,"aria-label":"Breadcrumb",children:a.jsx("ol",{className:"flex flex-wrap items-center gap-x-2 gap-y-1 text-sm",children:e.map((t,r)=>(0,a.jsxs)("li",{className:"flex items-center",children:[r>0&&a.jsx("svg",{className:"mx-2 h-4 w-4 shrink-0 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),t.href&&r<e.length-1?a.jsx(s.default,{href:t.href,className:"break-words text-gray-600 hover:text-brand-purple-600",children:t.label}):a.jsx("span",{className:"break-words font-medium text-gray-900",children:t.label})]},r))})})}},13518:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g,generateMetadata:()=>p});var a=r(19510);let s=(0,r(68570).createProxy)(String.raw`D:\PROJECT\Cursor\Banyco v2\Ecommerce\frontend\app\(shop)\products\ProductsPageClient.tsx#default`);var i=r(41447),l=r(12242),o=r(59441),n=r(24552);let c=e=>e?Array.isArray(e)?e.flatMap(e=>String(e).split(",")).map(e=>e.trim()).filter(Boolean):String(e).split(",").map(e=>e.trim()).filter(Boolean):[],u=e=>e&&["featured","newest","price-asc","price-desc","name-asc","rating"].includes(e)?e:"featured",d=e=>{if(!e)return 1;let t=Number(e);return!Number.isFinite(t)||t<1?1:Math.floor(t)};async function p({searchParams:e}){let t=await (0,n.N)("/products");return(0,n.v)(t,"/products",{title:"Sản Phẩm - Banyco",description:"Kh\xe1m ph\xe1 c\xe1c sản phẩm spa, salon chuy\xean nghiệp. Thiết bị massage, chăm s\xf3c da, mỹ phẩm v\xe0 vật tư l\xe0m đẹp.",ogImage:"/images/og-products.jpg"})}async function g({searchParams:e}){let t={},r=c(e.category);r.length&&(t.category=r);let n=c(e.brand);n.length&&(t.brand=n);let p=c(e.price);p.length&&(t.price=p);let g=c(e.availability);g.length&&(t.availability=g);let m=c(e.special);m.length&&(t.special=m);let h=u(e.sort),f=d(e.page),[{data:x,meta:y},b,v]=await Promise.all([(0,i.t)({page:f,pageSize:24,q:e.q,sort:h,category:e.category,brand:e.brand,price:e.price,availability:e.availability,special:e.special}),(0,l.g)(),(0,o.S)()]),P={selectedFilters:t,sortBy:h,searchQuery:e.q??"",page:y.page??f};return a.jsx(s,{initialProducts:x,initialMeta:y,categories:b,brands:v,initialState:P})}},59441:(e,t,r)=>{"use strict";r.d(t,{S:()=>l,b:()=>o});var a=r(15921),s=r(18722),i=r(83282);let l=async e=>{let t=(0,a.f8)(s.P.BRANDS.LIST),r=new URLSearchParams;e?.featured_only&&r.append("featured_only","true");let l=r.toString()?`${t}?${r.toString()}`:t;try{let e=await fetch(l,{next:{revalidate:300}});if(!e.ok)return console.error("[fetchBrands] Failed",e.statusText),[];return((await e.json()).data??[]).map(e=>({...e,logoUrl:(0,i.ZJ)(e.logo_url??e.logoUrl),product_count:Number(e.product_count)||0,primary_category:e.primary_category||null}))}catch(e){return console.error("[fetchBrands] Error",e),[]}},o=async e=>{let t=(0,a.f8)(`/brands/slug/${e}`);try{let e=await fetch(t,{next:{revalidate:300}});if(e.ok){let t=await e.json();if(t.data)return{...t.data,logoUrl:(0,i.ZJ)(t.data.logo_url??t.data.logoUrl),product_count:Number(t.data.product_count)||0,primary_category:t.data.primary_category||null}}}catch(e){console.error("[fetchBrandBySlug] Slug endpoint failed, trying detail endpoint",e)}let r=(0,a.f8)(s.P.BRANDS.DETAIL(e));try{let e=await fetch(r,{next:{revalidate:300}});if(!e.ok){if(404===e.status)return null;return console.error("[fetchBrandBySlug] Failed",e.statusText),null}let t=await e.json();if(!t.data)return null;return{...t.data,logoUrl:(0,i.ZJ)(t.data.logo_url??t.data.logoUrl),product_count:Number(t.data.product_count)||0,primary_category:t.data.primary_category||null}}catch(e){return console.error("[fetchBrandBySlug] Error",e),null}}},12242:(e,t,r)=>{"use strict";r.d(t,{E:()=>l,g:()=>i});var a=r(15921),s=r(83282);async function i(){try{let e=await fetch((0,a.f8)("/product-categories"),{next:{revalidate:60}});if(!e.ok)return console.error("[fetchProductCategories] Failed to load categories",e.statusText),[];let t=await e.json();return(t?.data??[]).map(e=>({id:e.id,name:e.name,slug:e.slug,description:e.description??null,imageUrl:(0,s.ZJ)(e.image_url),productCount:Number(e.product_count)||0}))}catch(e){return console.error("[fetchProductCategories] Error",e),[]}}async function l(e){try{let t=await fetch((0,a.f8)(`/product-categories/slug/${e}`),{next:{revalidate:60}});if(404===t.status)return null;if(!t.ok)return console.error("[fetchCategoryBySlug] Failed to fetch category",t.statusText),null;let r=await t.json();return{id:r.id,name:r.name,slug:r.slug,description:r.description??null,imageUrl:(0,s.ZJ)(r.image_url),productCount:Number(r.product_count)||0}}catch(e){return console.error("[fetchCategoryBySlug] Error",e),null}}},24552:(e,t,r)=>{"use strict";r.d(t,{N:()=>s,v:()=>i});var a=r(15921);async function s(e){try{let t=(0,a.kG)(),r=e;r.startsWith("/")||(r="/"+r),r.includes("?")&&(r=r.split("?")[0]),r=r.replace(/\/+$/,"")||"/";let s="/"===r?"":r.substring(1),i=`${t}/public/page-metadata/${s}`,l=await fetch(i,{next:{revalidate:300},headers:{"Cache-Control":"public, max-age=300"}});if(!l.ok){if(404!==l.status){let e=await l.text();console.error("[getPageMetadataFromCMS] API error:",l.status,e)}return null}return await l.json()}catch(e){return console.error("[getPageMetadataFromCMS] Error:",e),null}}function i(e,t,r){let s=(0,a.$2)(),i=(0,a.z9)(t),l=e?.title||r.title,o=e?.description||r.description,n=e?.ogImage&&""!==e.ogImage.trim()?e.ogImage:r.ogImage||"/images/banyco-logo.jpg",c=n.startsWith("http")?n:n.startsWith("/uploads")?(0,a.uD)(n):`${s}${n}`;return{title:{absolute:l},description:o,keywords:e?.keywords?.join(", ")||void 0,openGraph:{title:l,description:o,images:[{url:c,width:1200,height:630,alt:l}],type:"website",locale:"vi_VN",url:i,siteName:"Banyco"},twitter:{card:"summary_large_image",title:l,description:o,images:[c]},alternates:{canonical:i},robots:{index:!0,follow:!0}}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[6853,9024,4533,2975,5604,8334,8076,5095],()=>r(12477));module.exports=a})();